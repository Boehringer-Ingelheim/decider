<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function get_pred_tox() can be used to derive predictive
distributions of the DLT rates of a set of dose levels considered in a new
dose finding trial based on historical data from one or more dose-finding trials
based on a joint BLRM. The function supports both monotherapy and two-drug
combination therapy and is essentially a wrapper for get_MAP()
but additionally computes samples from the predictive DLT rates from the
drawn samples from the MAP prior. Note that this is equivalent to the posterior
distribution of the DLT rates of a trial that has not recorded
data yet from a joint BLRM including the specified co-data from other trials.
The function get_pred_tox() can be used for both monotherapy and
combination therapy.
For the former, the arguments dose2 and dose.ref2 can
be left out. The function get_pred_tox_mono() uses a slightly different
syntax and output structure that is specifically designed for settings consisting purely of
monotherapy trials."><title>Compute predictive DLT rates for a new trial from historical data — get_pred_tox • decider</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute predictive DLT rates for a new trial from historical data — get_pred_tox"><meta property="og:description" content="The function get_pred_tox() can be used to derive predictive
distributions of the DLT rates of a set of dose levels considered in a new
dose finding trial based on historical data from one or more dose-finding trials
based on a joint BLRM. The function supports both monotherapy and two-drug
combination therapy and is essentially a wrapper for get_MAP()
but additionally computes samples from the predictive DLT rates from the
drawn samples from the MAP prior. Note that this is equivalent to the posterior
distribution of the DLT rates of a trial that has not recorded
data yet from a joint BLRM including the specified co-data from other trials.
The function get_pred_tox() can be used for both monotherapy and
combination therapy.
For the former, the arguments dose2 and dose.ref2 can
be left out. The function get_pred_tox_mono() uses a slightly different
syntax and output structure that is specifically designed for settings consisting purely of
monotherapy trials."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">decider</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9012</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro_jointBLRM.html">Evaluate prior specifications of a joint BLRM for oncology dose finding</a>
    <a class="dropdown-item" href="../articles/parallelization_jointBLRM.html">Parallelizing functions of the decider package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute predictive DLT rates for a new trial from historical data</h1>
      
      <div class="d-none name"><code>get_pred_tox.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>get_pred_tox()</code> can be used to derive predictive
distributions of the DLT rates of a set of dose levels considered in a new
dose finding trial based on historical data from one or more dose-finding trials
based on a joint BLRM. The function supports both monotherapy and two-drug
combination therapy and is essentially a wrapper for <code><a href="get_MAP.html">get_MAP</a>()</code>
but additionally computes samples from the predictive DLT rates from the
drawn samples from the MAP prior. Note that this is equivalent to the posterior
distribution of the DLT rates of a trial that has not recorded
data yet from a joint BLRM including the specified co-data from other trials.</p>
<p>The function <code>get_pred_tox()</code> can be used for both monotherapy and
combination therapy.
For the former, the arguments <code>dose2</code> and <code>dose.ref2</code> can
be left out. The function <code>get_pred_tox_mono()</code> uses a slightly different
syntax and output structure that is specifically designed for settings consisting purely of
monotherapy trials.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_pred_tox</span><span class="op">(</span></span>
<span> <span class="va">doses.of.interest</span>,</span>
<span> <span class="va">dose1</span>,</span>
<span> <span class="va">dose2</span>,</span>
<span> <span class="va">dose.ref1</span>,</span>
<span> <span class="va">dose.ref2</span>,</span>
<span> <span class="va">n.pat</span>,</span>
<span> <span class="va">n.dlt</span>,</span>
<span> <span class="va">trial</span>,</span>
<span> prior.mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu_a1 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="logit.html">logit</a></span><span class="op">(</span><span class="fl">0.33</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                 mu_b1 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,           <span class="fl">1</span><span class="op">)</span>,</span>
<span>                 mu_a2 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="logit.html">logit</a></span><span class="op">(</span><span class="fl">0.33</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                 mu_b2 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,           <span class="fl">1</span><span class="op">)</span>,</span>
<span>                 mu_eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,           <span class="fl">1.121</span><span class="op">)</span></span>
<span>                 <span class="op">)</span>,</span>
<span> prior.tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tau_a1 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.25</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span><span class="op">)</span>,</span>
<span>                  tau_b1 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.125</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span><span class="op">)</span>,</span>
<span>                  tau_a2 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.25</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span><span class="op">)</span>,</span>
<span>                  tau_b2 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.125</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span><span class="op">)</span>,</span>
<span>                  tau_eta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.125</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span><span class="op">)</span></span>
<span>                  <span class="op">)</span>,</span>
<span> saturating <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span> return.samples <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span> probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span> dosing.intervals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.16</span>, <span class="fl">0.33</span><span class="op">)</span>,</span>
<span> <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_pred_tox_mono</span><span class="op">(</span></span>
<span> <span class="va">doses.of.interest</span>,</span>
<span> <span class="va">dose</span>,</span>
<span> <span class="va">dose.ref</span>,</span>
<span> <span class="va">n.pat</span>,</span>
<span> <span class="va">n.dlt</span>,</span>
<span> <span class="va">trial</span>,</span>
<span> prior.mu.mono <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu_a <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="logit.html">logit</a></span><span class="op">(</span><span class="fl">0.33</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                      mu_b <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,          <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span> prior.tau.mono <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tau_a <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.25</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span><span class="op">)</span>,</span>
<span>                       tau_b <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.125</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span><span class="op">)</span><span class="op">)</span>,</span>
<span> return.samples <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span> probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span> dosing.intervals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.16</span>, <span class="fl">0.33</span><span class="op">)</span>,</span>
<span> <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>doses.of.interest</dt>
<dd><p>Numerical that defines the set of dose levels for
which the meta-analytic predictive DLT rate is to be computed. Its specification
differs between <code>get_pred_tox()</code> and <code>get_pred_tox_mono()</code>.</p>
<p>For <code>get_pred_tox()</code>: Can be either
a vector of length 2 that describes a single dose combination (where one of
the doses can be set to 0 for monotherapy doses), or a matrix with 2 rows in
which each column defines a dose combination.</p>
<p>For <code>get_pred_tox_mono()</code>: Can be either a vector giving a set of monotherapy
dose levels, or a matrix with exactly one row or exactly one column. In both cases,
each number in the argument is interpreted as a single dose.</p></dd>


<dt>dose1</dt>
<dd><p>Numeric vector with non-negative entries. Describes the dose of
compound 1 administed to the patients of a cohort in the data, where cohort <code>i</code>
is assumed to have received <code>dose1[i]</code> of compound 1. Note that <code>dose1[i]</code>
can be set to 0 to indicate that a cohort received monotherapy with compound 2.</p></dd>


<dt>dose2</dt>
<dd><p>Numeric vector with non-negative entries. Describes the dose of
compound 2 administed to the patients of a cohort in the data, where cohort <code>i</code>
is assumed to have received <code>dose2[i]</code> of compound 2. Note that <code>dose2[i]</code>
can be set to 0 to indicate that a cohort received monotherapy with compound 1.</p></dd>


<dt>dose.ref1</dt>
<dd><p>Positive number, reference dose for compound 1.</p></dd>


<dt>dose.ref2</dt>
<dd><p>Positive number, reference dose for compound 2.</p></dd>


<dt>n.pat</dt>
<dd><p>Numeric vector with non-negative whole numbers as entries. <code>n.pat[i]</code>
indicates the number of patients that were treated in cohort <code>i</code>.</p></dd>


<dt>n.dlt</dt>
<dd><p>Numeric vector with non-negative whole numbers as entries. <code>n.dlt[i]</code>
indicates the number of patients that experienced DLT in cohort <code>i</code>.</p></dd>


<dt>trial</dt>
<dd><p>Numerical or character vector that indicates to which trial a cohort is assigned to.
The entries can either be numericals or strings, where <code>1</code> and <code>"1"</code>
would be interpreted as the same trial. Note that the given entries are internally
converted to numbers from 1 to the number of different studies if not already
given in this form.</p></dd>


<dt>prior.mu</dt>
<dd><p>Named list that specifies the distribution of the
hypermeans of the parameters of the combination therapy BLRM. Same format,
default, and requirements as documented for the function
<code><a href="scenario_jointBLRM.html">scenario_jointBLRM</a>()</code>.</p></dd>


<dt>prior.tau</dt>
<dd><p>Named list that specifies the distribution of the
between-trial heterogeneities of the parameters of the combination therapy BLRM.
Same format, default, and requirements as documented for the function
<code><a href="scenario_jointBLRM.html">scenario_jointBLRM</a>()</code>.</p></dd>


<dt>saturating</dt>
<dd><p>Optional logical, defaults to <code>FALSE</code>. If <code>TRUE</code>, the BLRM will be using a saturating interaction term as described in
<code>OncoBayes2::blrm_formula_saturating()</code>. Also refer to the Details section in the documentation
of <code><a href="scenario_jointBLRM.html">scenario_jointBLRM</a>()</code>.</p></dd>


<dt>return.samples</dt>
<dd><p>Optional logical, defaults to <code>FALSE</code>. If <code>TRUE</code>,
the function will return a matrix with samples from the MAP prior additionally
to a prior summary.</p></dd>


<dt>probs</dt>
<dd><p>Optional numerical, defaults to <code>c(0.025, 0.5,  0.975)</code>.
Indicates which quantiles should be included in the posterior summaries.</p></dd>


<dt>dosing.intervals</dt>
<dd><p>Optional numeric ascending positive entries between 0 and 1.
Defines the limits of the dosing intervals to be evaluated, similarly to
<code><a href="scenario_jointBLRM.html">scenario_jointBLRM</a>()</code>. The default value
is <code>c(0.16, 0.33)</code>.</p></dd>


<dt>...</dt>
<dd><p>Optional additional arguments that are passed to <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">rstan::sampling()</a></code>. These
include the settings for MCMC and the random seed. Refer
to the <code><a href="https://mc-stan.org/rstan/reference/rstan.html" class="external-link">rstan-package</a></code> for an overview. Note that
the function will automatically use <code>iter=10000</code> and a <code>control</code> argument
containing <code>adapt_delta=0.9</code> to ensure a relatively good fit if the
arguments <code>iter</code> and <code>control</code> for <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">rstan::sampling()</a></code>
are not provided manually in <code>...</code>.</p></dd>


<dt>dose</dt>
<dd><p>Numeric vector with non-negative entries that defines the monotherapy dose
levels administered to each cohort.</p></dd>


<dt>dose.ref</dt>
<dd><p>Positive numerical, reference dose for monotherapy.</p></dd>


<dt>prior.mu.mono</dt>
<dd><p>Optional named list that specifies the prior. Must have the
entries <code>mu_a</code> and <code>mu_b</code>, both of which must be vectors of length 2,
where the second entry is a positive number.<br>
The entries need to be:</p><ul><li><p><code>...$mu_a</code>:<br>
Defaults to <code>c(logit(0.33), 2)</code>, provides mean and SD of the normal distribution used as
hypermean of \(log(\alpha)\).</p></li>
<li><p><code>...$mu_b</code>:<br>
Defaults to <code>c(0, 1)</code>, provides mean and SD of the normal distribution used as
hypermean of \(log(\beta)\).</p></li>
</ul></dd>


<dt>prior.tau.mono</dt>
<dd><p>Optional named list that specifies the prior. Must have the
entries <code>tau_a</code> and <code>tau_b</code>, both of which must be vectors of length 2,
where the second entry is a positive number.<br>
The entries need to be:</p><ul><li><p><code>...$tau_a</code>:<br>
Defaults to <code>c(log(0.25), log(2)/1.96)</code>, provides mean and SD (on log-scale) of the log-normal distribution used as
between-trial heterogeneity of \(log(\alpha)\).</p></li>
<li><p><code>...$tau_b</code>:<br>
Defaults to <code>c(log(0.125), log(2)/1.96)</code>, provides mean and SD (on log-scale) of the log-normal distribution used as
between-trial heterogeneity of \(log(\beta)\).</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Refer to the documentation of <code><a href="scenario_jointBLRM.html">scenario_jointBLRM</a>()</code>
for a description of the underlying model used to compute predictive distributions
of the DLT rates.</p>
<p>The function <code>get_pred_tox()</code> can optionally return the samples from the
predictive distribution, which can in turn be used to perform single-dose analyses
using e.g. a binomial-beta-mixture model.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Stan Development Team (2020). RStan: the R interface to Stan. R package version 2.21.2. <a href="https://mc-stan.org" class="external-link">https://mc-stan.org</a>.</p>
<p>Neuenschwander, B., Branson, M., &amp; Gsponer, T. (2008). Critical aspects of the Bayesian approach to phase I cancer trials.
Statistics in medicine, 27(13), 2420-2439, <a href="doi:10.1002/sim.3230">doi:10.1002/sim.3230</a>.</p>
<p>Schmidli, H., Gsteiger, S., Roychoudhury, S., O'Hagan, A., Spiegelhalter, D., &amp; Neuenschwander B. (2014).
Robust meta-analytic-predictive priors in clinical trials with historical control information.</p>
<p>Neuenschwander, B., Matano, A., Tang, Z., Roychoudhury, S., Wandel, S., &amp; Bailey, S. (2014). A Bayesian Industry Approach to Phase I Combination Trials in Oncology.
In: Zhao. W &amp; Yang, H. (editors). Statistical methods in drug combination studies. Chapman and Hall/CRC, 95-135, <a href="doi:10.1201/b17965">doi:10.1201/b17965</a>.</p>
<p>Neuenschwander, B., Roychoudhury, S., &amp; Schmidli, H. (2016). On the use of co-data in clinical trials.
Statistics in Biopharmaceutical Research, 8(3), 345-354, <a href="doi:10.1080/19466315.2016.1174149">doi:10.1080/19466315.2016.1174149</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="get_MAP.html">get_MAP</a>()</code>,
<code><a href="scenario_jointBLRM.html">scenario_jointBLRM</a>()</code>,
<code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-sampling.html" class="external-link">rstan::sampling()</a></code>, <code><a href="https://mc-stan.org/rstan/reference/rstan.html" class="external-link">rstan-package</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">#derive the predictive distribution of the DLT rate of the dose 10+24</span></span></span>
<span class="r-in"><span><span class="co">#from historical data of three previous trials</span></span></span>
<span class="r-in"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu">get_pred_tox</span><span class="op">(</span></span></span>
<span class="r-in"><span> doses.of.interest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">24</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> dose1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">4</span>,  <span class="fl">8</span>,  <span class="fl">10</span>, <span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> dose2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">12</span>, <span class="fl">24</span>, <span class="fl">36</span>, <span class="fl">24</span>, <span class="fl">24</span>, <span class="fl">24</span>, <span class="fl">24</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> n.pat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">9</span>,  <span class="fl">6</span>,  <span class="fl">3</span>,  <span class="fl">12</span>, <span class="fl">3</span>,  <span class="fl">3</span>,  <span class="fl">3</span>,  <span class="fl">9</span>,  <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> n.dlt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,  <span class="fl">2</span>,  <span class="fl">0</span>,  <span class="fl">1</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">1</span>,  <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>,  <span class="fl">1</span>,  <span class="fl">2</span>,  <span class="fl">2</span>,  <span class="fl">2</span>,  <span class="fl">3</span>,  <span class="fl">3</span>,  <span class="fl">3</span>,  <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> dose.ref1 <span class="op">=</span> <span class="fl">14</span>,</span></span>
<span class="r-in"><span> dose.ref2 <span class="op">=</span> <span class="fl">24</span>,</span></span>
<span class="r-in"><span> return.samples <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#summary</span></span></span>
<span class="r-in"><span><span class="va">pred</span><span class="op">$</span><span class="va">summary</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#first eight samples from predictive DLT rate</span></span></span>
<span class="r-in"><span><span class="va">pred</span><span class="op">$</span><span class="va">samples</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">#derive the predictive distribution of the DLT rates of the doses 8, 12, and</span></span></span>
<span class="r-in"><span><span class="co">#14 (monotherapy) from historical data of two previous trials</span></span></span>
<span class="r-in"><span><span class="va">pred_mono</span> <span class="op">&lt;-</span> <span class="fu">get_pred_tox_mono</span><span class="op">(</span></span></span>
<span class="r-in"><span> doses.of.interest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">12</span>, <span class="fl">14</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> dose  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">10</span>, <span class="fl">14</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> n.pat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">9</span>,  <span class="fl">6</span>,  <span class="fl">6</span>,  <span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> n.dlt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,  <span class="fl">2</span>,  <span class="fl">0</span>,  <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>,  <span class="fl">1</span>,  <span class="fl">2</span>,  <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> dose.ref <span class="op">=</span> <span class="fl">14</span>,</span></span>
<span class="r-in"><span> return.samples <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#summary</span></span></span>
<span class="r-in"><span><span class="va">pred_mono</span><span class="op">$</span><span class="va">summary</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#first eight samples from predictive DLT rates</span></span></span>
<span class="r-in"><span><span class="va">pred_mono</span><span class="op">$</span><span class="va">samples</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Lukas Schroeter, Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

