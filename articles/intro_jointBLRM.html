<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="decider">
<title>Evaluate prior specifications of a joint BLRM for oncology dose finding • decider</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Evaluate prior specifications of a joint BLRM for oncology dose finding">
<meta property="og:description" content="decider">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">decider</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9012</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro_jointBLRM.html">Evaluate prior specifications of a joint BLRM for oncology dose finding</a>
    <a class="dropdown-item" href="../articles/parallelization_jointBLRM.html">Parallelizing functions of the decider package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Evaluate prior specifications of a joint BLRM for oncology dose finding</h1>
            
      
      
      <div class="d-none name"><code>intro_jointBLRM.Rmd</code></div>
    </div>

    
    
<p>This vignette illustrates the usage of the <code>decider</code>
package for setting up and evaluating prior distributions for joint
Bayesian logistic regression model (BLRM)-based dose-finding trials with
one or more monotherapy and/or two-compund combination therapy trials
that may run sequentially or in parallel. It will be assumed that the
reader is familiar with the general process of dose-limiting toxicity
(DLT)-based dose-finding trials with the aim of determining a
maximum-tolerated dose (MTD) and with the BLRM and its meta-analytic
extensions (here referred to as joint BLRM) for DLT-based dose finding.
For an introduction to these topics, refer to <span class="citation">(Neuenschwander, Branson, and Gsponer 2008)</span>,
<span class="citation">(Neuenschwander et al. 2014)</span>, <span class="citation">(Neuenschwander, Roychoudhury, and Schmidli
2016)</span>. While this terminology and the applied methods mainly
originated in the context of oncology dose finding, the methods
contained in this vignette can also be applied to other therapeutic
areas. Note that different therapeutic areas may be using a slightly
different notions instead of e.g. DLT and MTD.</p>
<p>Note further that the term “trial” may also refer to a trial arm
(e.g. monotherapy and combination therapy), and that the model will not
differentiate between these notions. Moreover, the term “study” will
refer to the complete conduct of all jointly modeled trials. That is,
simulating e.g. 10 studies means that all involved trials are simulated
in the specified order and under the remaining specified assumptions for
in total 10 times.</p>
<div class="section level2">
<h2 id="overview-of-the-main-tools">Overview of the main tools<a class="anchor" aria-label="anchor" href="#overview-of-the-main-tools"></a>
</h2>
<p>The package ships with two main functions, which are called
<code>scenario_jointBLRM</code> and <code>sim_jointBLRM</code>. The
former is essentially a high-level wrapper for fitting a joint BLRM to a
concrete data scenario, while the latter allows to simulate the course
of a number of dose-finding trials under the assumption of a specific
dose-toxicity scenario, i.e. a specification of the DLT rates of the
involved dose levels.</p>
<div class="section level3">
<h3 id="scenario_jointblrm">
<code>scenario_jointBLRM</code><a class="anchor" aria-label="anchor" href="#scenario_jointblrm"></a>
</h3>
<p>The function <code>scenario_jointBLRM</code> is essentially a wrapper
for a Stan model of the joint BLRM, which is internally used to sample
from the posterior distribution given a set of input data using the
so-called No-U-Turn sampler (NUTS) algorithm. For details on the
technicalities behind Stan, a good starting place is Stan’s <a href="https://mc-stan.org" class="external-link">homepage</a>.</p>
<p>However, besides fitting the model, the function will also perform a
number of further evaluations based on the posterior. Most importantly,
the posterior distribution of the DLT rates (referred to as posterior
toxicities in the following) for a given set of dose levels is
determined based on the fitted model. In actual dose-finding trials
these distributions will form the basis of the recommended dose level
for the next cohort.</p>
<p>The output of <code>scenario_jointBLRM</code> consist of a summary of
these posterior toxicities, as well as an evaluation of them in terms of
an specific escalation rule. Here, the term escalation rule refers to a
method that derives a dosing recommendation based on the fitted BLRM.
Currently, the <code>decider</code> package supports the popular
escalation with overdose control (EWOC)-based escalation rules <span class="citation">(Babb, Rogatko, and Zacks 1998)</span>, as well as
loss-based escalation rules, which are however not considered in this
vignette. Note that EWOC-based escalation is the default setting of all
functions, so that without further specifications, the functions will
assume that EWOC is applied. Essentially, EWOC computes the probability
that the DLT rate of a dose lies above a prespecified target dosing
interval (often from 16% to 33% DLT rate), and demands that this
probability does not exceed a certain boundary, typically 0.25 (the
default). Both the interval and the boundary can be adapted by the user.
For EWOC-based escalation, the summary that
<code>scenario_jointBLRM</code> creates will contain the resulting
posterior interval probabilities of underdosing, target dosing, and
overdosing, as well as summary statistics of the posterior of the DLT
rates of a given set of doses of interest (which are usually the set of
possible dose levels in the trial).</p>
<p>Additionally, plots of the posterior interval probabilities can be
created, which visualize the EWOC principle and the set of doses that is
allowed by EWOC based on the given data.</p>
<p>The main uses of <code>scenario_jointBLRM</code> are the evaluation
of actual and hypothetical data scenarios and the determination of the
resulting posterior. Actual data scenarios refer here to data that was
observed during a trial, while hypothetical data scenarios are a way of
evaluating the on-trial behavior of the BLRM with some escalation rule
in a concrete setting. These are particularly important at the planning
stage of dose-finding trials, as they allow to monitor the performance
of the model in scenarios that are assumed to potentially occur during
the trial. Based on these evaluations, the prior distribution of the
BLRM can be adapted to obtain appropriate escalation behavior.</p>
<p>For evaluating a prior specification at the planning stage of a
trial, one will typically need to consider a whole set of different
scenarios that test the model and its recommendation in a broad spectrum
of possible situations. Specifically for this setting, the additional
function <code><a href="../reference/scenario_list_jointBLRM.html">scenario_list_jointBLRM()</a></code> is provided, which
allows to evaluate a list of arbitrarily many scenarios via
<code><a href="../reference/scenario_jointBLRM.html">scenario_jointBLRM()</a></code> in parallel.</p>
</div>
<div class="section level3">
<h3 id="sim_jointblrm">
<code>sim_jointBLRM</code><a class="anchor" aria-label="anchor" href="#sim_jointblrm"></a>
</h3>
<p>When a prior with appropriate on-trial behavior is established, one
may want to conduct more thorough evaluation of the performance of the
resulting model. A widely-accepted way of achieving this are trial
simulations. For this, one assumes concrete “true” DLT rates for the
dose levels available in a trial (referred to as dose-toxicity scenario)
and repeatedly simulates the number of DLTs that are observed in cohorts
of patients. Based on this data, the BLRM is fitted and the escalation
rule is applied to determine the dose level for the next cohort, or,
potentially, if the trial needs to be stopped early (this can
e.g. happen when the lowest available dose does not satisfy the EWOC
criterion). This process is repeated until a prespecified condition for
the declaration of the MTD is reached, or until the trial is stopped
without declaring an MTD (either due to stopping early or due to
reaching the maximum number of patients that can be enrolled).</p>
<p>Such trial simulation can then be used to determine the operating
characteristics of the trial design in specific dose-toxicity scenarios.
That is, one simulates a number of trials, e.g. 1000, and determines the
ratio of MTDs declared at specific dose levels (e.g., MTDs at target
doses), as well as further quantities like the average number of
patients treated with a specific dose or the average number of DLTs that
occurred during the trial.</p>
<p>This process is then repeated for a number of different scenarios,
containing e.g. low-toxicity scenarios (all doses have DLT rate below
the targeted interval), moderate scenarios (DLT rates range from
underdoses over target doses to overdoses), highly toxic scenarios, and
further extreme cases, like e.g. one trial being considerably more toxic
than another one.</p>
<p>The function <code><a href="../reference/sim_jointBLRM.html">sim_jointBLRM()</a></code> is designed to perform
these simulations in a convenient manner and generate output tables that
summarize the operating characteristics of a specified trial design in
concrete dose-toxicity scenarios. It provides the option two simulate up
to six trials running in parallel (which can be activated independently
of each other), namely two monotherapy trials for each involved
compound, and two combination therapy trias which are all included in a
joint meta-analytic BLRM which is specified according to <span class="citation">(Neuenschwander et al. 2014)</span>, <span class="citation">(Neuenschwander, Roychoudhury, and Schmidli
2016)</span>.</p>
<p>The priors used by the model and the order in which cohorts arrive
can be freely specified by the user, as well as many further options,
including escalation rules, MTD selection, starting doses, and
additional restrictions on the increment between escalations.
Furthermore, the function allows to include data from arbitrarily many
historical trials (not actively simulated) for the involved
compounds.</p>
</div>
</div>
<div class="section level2">
<h2 id="setting-up-and-evaluating-priors-using-scenario_jointblrm">Setting up and evaluating priors using
<code>scenario_jointBLRM</code><a class="anchor" aria-label="anchor" href="#setting-up-and-evaluating-priors-using-scenario_jointblrm"></a>
</h2>
<p>Assume in the following that we are interested in setting up an
oncology dose-finding study that includes two different trials, referred
to as Arm A and Arm B in the following. Suppose that Arm A investigates
on some treatment, say compound 1, in a first-in-human monotherapy
setting, while Arm B shall consider combination therapy with compound 1
and some combination partner, say compound 2. We assume that previous
dose-finding trials for compound 2 were already conducted, so that DLT
data is available for monotherapy with compound 2 from earlier clinical
investigations.</p>
<p>Assume further that Arm A and Arm B shall run partially in parallel,
or, more precisely, that Arm B will be initiated before Arm A has
concluded (before the trial declared an MTD), provided that the involved
doses of compound 1 were already tested in monotherapy. To allow
exchange of information across Arms A and B, and further the inclusion
of the historical data for compound 2, we will model both trials and the
historical trials in a joint BLRM. The following sections provide an
overview how the function <code>scenario_jointBLRM</code> can be set up
for this situation, and how it is used to specify and evaluate an
appropriate prior distribution and conduct analyses to determine the
next dose level during the trial.</p>
<p>Before you continue, do not forget to load the <code>decider</code>
package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Boehringer-Ingelheim.github.io/decider/">decider</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="basic-specifications-of-scenario_jointblrm">Basic specifications of <code>scenario_jointBLRM</code><a class="anchor" aria-label="anchor" href="#basic-specifications-of-scenario_jointblrm"></a>
</h3>
<p>As a first step, we will determine the necessary fixed input data,
consisting of a set of available dose levels for Arms A ad B, the set of
historical data, and reference dose levels for both compounds.</p>
<p>First, assume that from an historical monotherapy trial for compound
2, the clinical data given below is available. Dose levels of the same
compound are assumed to be stated in some fixed unit of measurement,
e.g. mg or mg/kg, which is not explicitly denoted for simplicity.</p>
<table class="table">
<thead><tr class="header">
<th>Dose</th>
<th>#Patients</th>
<th>#DLT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>3</td>
<td>0</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>0</td>
</tr>
<tr class="odd">
<td>8</td>
<td>3</td>
<td>0</td>
</tr>
<tr class="even">
<td>12</td>
<td>9</td>
<td>1</td>
</tr>
<tr class="odd">
<td>16</td>
<td>12</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>It is further assumed that all of these observations originate from a
single historical trial, although this could easily be extended to
multiple historical trials (described below).</p>
<p>The given data now needs to be written in the format that
<code>scenario_jointBLRM</code> accepts, which is a named list
containing the entries <code>dose1</code>, <code>dose2</code>,
<code>n.pat</code>, <code>n.dlt</code>, and <code>trial</code>. For the
data given above, use</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">historical.data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  dose1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,</span>
<span>  dose2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">2</span>,    <span class="fl">4</span>,    <span class="fl">8</span>,    <span class="fl">12</span>,   <span class="fl">16</span><span class="op">)</span>,</span>
<span>  n.pat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">3</span>,    <span class="fl">3</span>,    <span class="fl">3</span>,    <span class="fl">9</span>,    <span class="fl">12</span><span class="op">)</span>,</span>
<span>  n.dlt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">1</span>,    <span class="fl">2</span><span class="op">)</span>,</span>
<span>  trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H1"</span>, <span class="st">"H1"</span>, <span class="st">"H1"</span>, <span class="st">"H1"</span>, <span class="st">"H1"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here, each column in the structure given above translates to the data
observed at one dose level during a specific historical trial. Note that
the dose levels of compound 2 are given in the entry <code>dose2</code>,
while the entry of <code>dose1</code> is <code>0</code> to indicate that
the cohorts received monotherapy with compound 2.</p>
<p>In the example here, only the data from one historical trial is
included. For this, the same entry of <code>historical.data$trial</code>
is given for each historical cohort, which tells the function that all
of these cohorts belong to the same trial. The entry <code>"H1"</code>
is an arbitrarily chosen trial name for the historical trial, note that
one could also use a specific number or some other string as trial name.
When data for multiple historical trials in given, multiple trial names
need to be used to indicate this.</p>
<p>As a next step, we need to specify reference dose levels and the set
of available dose levels for the trial. Although the set of
investigational dose levels can be flexible in practice (i.e., does not
need full specification at the planning stage), for prior evaluations, a
hypothetical set of doses that are planned to be used in the trial need
to be specified to allow evaluating the hypothetical on-trial behavior
of the model.</p>
<p>We will in the following assume that the planned monotherapy doses
for compound 1 are</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">2.4</span>, <span class="fl">3.6</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<p>where we have again left out the unit of measurement (e.g. g or
mg/kg) for simplicity. Regarding combination therapy, suppose that it is
planned to consider all combinations of the monotherapy doses of
compound 1 with the dose levels</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<p>of compound 2 (given in the same unit of measurement as the doses in
the historical data).</p>
<p>The planned monotherapy and combination therapy doses should be given
to the function via the argument <code>doses.of.interest</code>, which
specifies which dose levels need to be evaluated. The argument needs to
be a matrix with two rows and one column for each dose level, where
monotherapy doses are indicated by placing <code>0</code> or
<code>NA</code> in the entry of the other compound.</p>
<p>In the setting specified above, this results in</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doses.of.interest</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">d1</span>,                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">d1</span>, times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">d2</span>, each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="co">#monotherapy compound 1.</span></span>
<span><span class="va">doses.of.interest</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]</span></span>
<span><span class="co">#&gt; [1,]  0.1  0.2  0.4  0.8  1.6  2.4  3.6    5    6</span></span>
<span><span class="co">#&gt; [2,]  0.0  0.0  0.0  0.0  0.0  0.0  0.0    0    0</span></span>
<span></span>
<span><span class="co">#combinations of compound 1 with dose 8 of compound 2.</span></span>
<span><span class="va">doses.of.interest</span><span class="op">[</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]</span></span>
<span><span class="co">#&gt; [1,]  0.1  0.2  0.4  0.8  1.6  2.4  3.6    5    6</span></span>
<span><span class="co">#&gt; [2,]  8.0  8.0  8.0  8.0  8.0  8.0  8.0    8    8</span></span>
<span></span>
<span><span class="co">#combinations of compound 1 with dose 12 of compound 2.</span></span>
<span><span class="va">doses.of.interest</span><span class="op">[</span>, <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]</span></span>
<span><span class="co">#&gt; [1,]  0.1  0.2  0.4  0.8  1.6  2.4  3.6    5    6</span></span>
<span><span class="co">#&gt; [2,] 12.0 12.0 12.0 12.0 12.0 12.0 12.0   12   12</span></span></code></pre></div>
<p>Next, we need to specify the reference doses used by the joint BLRM.
We assume that for compound 1 the dose <code>6</code> and for compound 2
the dose <code>12</code> was selected for this:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dose.ref1</span> <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="va">dose.ref2</span> <span class="op">=</span> <span class="fl">12</span></span></code></pre></div>
<p>To explicitly tell the function that we are interested in two trials
which consider monotherapy for compound 1, respectively combination
therapy, we now include the following optional arguments:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trials.of.interest</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,     <span class="st">"B"</span><span class="op">)</span></span>
<span><span class="va">types.of.interest</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mono1"</span>, <span class="st">"combi"</span><span class="op">)</span></span></code></pre></div>
<p>The trial names <code>"A"</code> and <code>"B"</code> are arbitrary
and tell the function that this is how we will indicate the two trials
in the data. The types <code>"mono1"</code> and <code>"combi"</code>
specify that only the <code>doses.of.interest</code> for the
corresponding trial type need to be analyzed for the corresponding
trial. That is, trial <code>"A"</code> is the trial of type
<code>"mono1"</code> and will only consider monotherapy with compound 1,
while <code>"combi"</code> indicates that trial <code>"B"</code> will
only consider combination therapy doses. There is also the type
<code>"all"</code> which will cause the function to analyze all given
doses of interest for a trial.</p>
<p>If the trials of interest or their type are not explicitly specified,
the function will use all trial names given in data and historical data
(in our case, including the trial <code>"H1"</code> from the historical
data), and further try to infer the type from the given data for this
trial. If this is not possible, (e.g. when no data is given yet), the
function will provide posteriors for all doses of interest for this
trial. Therefore, specifying trials of interest and their types allows
to control which output is included in a more precise fashion.</p>
<p>Furthermore, when we do not provide data for trial <code>"A"</code>
or <code>"B"</code> yet (e.g. to obtain the predictive distribution
induced by the data from the other included trials), the function would
not include the posterior of the trial in the output unless its name is
specified explicitly as a trial of interest. For instance, when only the
historical data is given, the function would only estimate the posterior
of the historical trials but not estimate the predictive distribution of
a new trial based on the historical data.</p>
<p>At this point, we could in principle already run the function to
produce posterior predictive distributions for the trials
<code>"A"</code> and <code>"B"</code> purely from the historical data of
trial <code>"H1"</code> (which is equivalent to a meta-analytic
predictive prior, cf. <span class="citation">(Neuenschwander,
Roychoudhury, and Schmidli 2016)</span>). However, we still have not
specified a (hyper-)prior distribution for the model, so that the
function would apply the default prior configuration (refer to the
documentation of <code>scenario_jointBLRM</code>). While the default
prior is weakly informative and was found to be quite flexible across
different situations, it is still recommended to specify a prior
manually to ensure good on-trial behavior of the model This will be the
subject of the next section.</p>
</div>
<div class="section level3">
<h3 id="specifying-a-prior-for-the-joint-blrm">Specifying a prior for the joint BLRM<a class="anchor" aria-label="anchor" href="#specifying-a-prior-for-the-joint-blrm"></a>
</h3>
<p>Refer to the section Detail in the documentation of
<code>scenario_jointBLRM</code> for a model specification of the joint
BLRM and explanations what the model does. For the following, it is only
important to know that the prior specifications consist of two parts,
namely, a prior for the hyper-means (argument <code>prior.mu</code>) and
a prior for the between-trial heterogeneities (argument
<code>prior.tau</code>), where the hyper-mean is the shared mean of the
parameters across trials and the between-trial heterogeneity is the
standard deviation across trials. Recall the five different parameters
of the joint BLRM: two parameters for each compound (more precisely, the
intercept <span class="math inline">\(log(\alpha_i)\)</span> and the
log-slope <span class="math inline">\(log(\beta_i)\)</span> for compound
<span class="math inline">\(i\)</span>), and the interaction parameter,
<span class="math inline">\(\eta\)</span>. Hence, the prior
specification must specify the distribution of the hypermean and
between-trial heterogeneity for these five parameters.</p>
<p>For this, it is assumed that all hypermeans follow normal
distributions with some fixed mean and SD (which are therefore the input
required to specify the distribution of each hypermean), while the
heterogeneities are assumed to follow log-normal distributions, whose
mean and SD (on log-scale) need to be given to the function.
Technically, it is further assumed that for each <span class="math inline">\(i\)</span>, <span class="math inline">\(log(\alpha_i)\)</span> and <span class="math inline">\(log(\beta_i)\)</span> may be correlated with some
correlation coefficient <span class="math inline">\(\rho\)</span>, but
this hyperparameter is automatically assigned a uniform distribution on
the interval <span class="math inline">\([-1, 1]\)</span>, so that its
prior does not need to be specified.</p>
<div class="section level4">
<h4 id="prior-for-the-hypermeans-prior-mu">Prior for the hypermeans: <code>prior.mu</code><a class="anchor" aria-label="anchor" href="#prior-for-the-hypermeans-prior-mu"></a>
</h4>
<p>First, consider the prior for the hypermeans, which is encoded in the
argument <code>prior.mu</code>. This must be a list with five named
entries, where each entry provides the mean and SD of the distribution
of one of the five hypermeans.</p>
<p>The expected format of this argument is:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#               Parameter    Mean        SD</span></span>
<span><span class="va">prior.mu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu_a1  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.7081851</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                mu_b1  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,          <span class="fl">1</span><span class="op">)</span>,</span>
<span>                mu_a2  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.7081851</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                mu_b2  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,          <span class="fl">1</span><span class="op">)</span>,</span>
<span>                mu_eta <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,          <span class="fl">1.121</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Here, the prefix <code>mu</code> indicates that this is a hypermean,
while the suffixes correspond to the parameters as given in the
following table.</p>
<table class="table">
<thead><tr class="header">
<th>Parameter</th>
<th>Suffix</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(log(\alpha_1)\)</span></td>
<td><code>_a1</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(log(\beta_1)\)</span></td>
<td><code>_b1</code></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(log(\alpha_2)\)</span></td>
<td><code>_a2</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(log(\beta_2)\)</span></td>
<td><code>_b2</code></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\eta\)</span></td>
<td><code>_eta</code></td>
</tr>
</tbody>
</table>
<p>In the prior list, each of the entries should be of the form
<code>c(x, y)</code>, where <code>x</code> gives the mean and
<code>y</code> the SD of the normal distribution assumed for the
hypermean of the corresponding parameter.</p>
<p>The default values were oriented towards <span class="citation">(Neuenschwander et al. 2014)</span> and <span class="citation">(Neuenschwander, Roychoudhury, and Schmidli
2016)</span>, and represent a relatively flexible, weakly informative
prior distribution. It is recommended that this is used as a starting
point for adapting the prior to a given setting, as specific modifations
to match the setting of a concrete trial will most likely provide better
performance than the default prior.</p>
<p>Regarding the interpretation of the parameter, <span class="math inline">\(log(\alpha_i)\)</span> gives the median log-odds
of experiencing a DLT following treatment at the reference dose. The
value <code>-0.7081851</code> corresponds to</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/logit.html">logit</a></span><span class="op">(</span><span class="fl">0.33</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.7081851</span></span></code></pre></div>
<p>which means that one assumes the reference dose to have in median a
DLT rate of 33%. This corresponds precisely to the upper boundary of the
default target interval (from 16% to 33%), so that the prior expresses
the assumption that the reference dose is a priori a possible candidate
for the MTD (note that the reference dose should be chosen
accordingly).</p>
<p>The default value of the SD of the hypermeans of <span class="math inline">\(log(\alpha_i)\)</span> is <code>2</code>, which
represents a relatively large uncertainty and leads to relatively
flexible prior. Note however that depending on the dosing range and
other specifications of the trial, one might want to deviate from this
default value. For instance, we may want to assume a slightly larger
uncertainty regarding the intercept to obtain a more conservative setup,
e.g. via</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior.mu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu_a1  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.7081851</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                mu_b1  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,          <span class="fl">1</span><span class="op">)</span>,</span>
<span>                mu_a2  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.7081851</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                mu_b2  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,          <span class="fl">1</span><span class="op">)</span>,</span>
<span>                mu_eta <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,          <span class="fl">1.121</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Regarding the hyperpriors for <span class="math inline">\(log(\beta)\)</span>, a standard normal
distribution is assumed. This covers a relatively broad range of slopes,
although one may want to select a larger or smaller SD in certain cases.
Regarding the mean, it is typically not necessary to deviate from the
default of <code>0</code> unless there is very concrete information
about the shape of the dose-toxicity relationship.</p>
<p>For the interaction parameter, recall that negative values of <span class="math inline">\(\eta\)</span> express a lower DLT rate of dose
combinations than the interaction free-case (in which the compounds
would cause DLT fully independently from each other), while positive
values lead to a larger DLT rate compared to the interaction-free case.
The default value of <span class="math inline">\(0\)</span> for the mean
expresses that both positive and negative interactions may occur, while
the SD of 1.121 is selected so that the 95% credible interval of the
interaction-parameters corresponds to an increase up to 9-fold (or
decrease by factor of 9) of the odds for a DLT at the reference dose.
Larger or lower values of mean and SD can be used to obtain more
aggressive or conservative behavior of combination trials. Refer e.g. to
<span class="citation">(Neuenschwander et al. 2014)</span> for more
detail on this.</p>
</div>
<div class="section level4">
<h4 id="prior-for-the-between-trial-heterogeneities-prior-tau">Prior for the between-trial heterogeneities:
<code>prior.tau</code><a class="anchor" aria-label="anchor" href="#prior-for-the-between-trial-heterogeneities-prior-tau"></a>
</h4>
<p>The prior parameters for the between-trial heterogeneity control the
amount of borrowing that is performed across trials. In this context,
the assumption of a larger heterogeneity for a parameter allows this
parameter to show larger variance across trials, and, consequently,
reduces the influence that data from other trials have on each jointly
modeled trial.</p>
<p>The decider package assumes that the between-trial heterogeneities
follow log-normal distributions, which are specified by providing their
mean and SD on log-scale.</p>
<p>The default value and required format of <code>prior.tau</code>
is:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#                Parameter    Mean        SD</span></span>
<span><span class="va">prior.tau</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tau_a1  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.25</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span><span class="op">)</span>,</span>
<span>                 tau_b1  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.125</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span><span class="op">)</span>,</span>
<span>                 tau_a2  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.25</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span><span class="op">)</span>,</span>
<span>                 tau_b2  <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.125</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span><span class="op">)</span>,</span>
<span>                 tau_eta <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.125</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The naming conventions are the same as for <code>prior.mu</code>.</p>
<p>Note that a value of <code>c(x,y)</code> as <code>tau_[...]</code>
provides the mean <code>x</code> and SD <code>y</code> on log-scale,
i.e. if the corresponding hyperparameter is denoted as <span class="math inline">\(\tau\)</span>, the function assumes that <span class="math inline">\(\tau=exp(\psi)\)</span> for some random variable
<span class="math inline">\(\psi\)</span> that is normally distributed
with mean <code>x</code> and SD <code>y</code>.</p>
<p>The default values are oriented towards <span class="citation">(Neuenschwander et al. 2014)</span>. Note that the SDs
are typically all set to either <code>log(2)/1.96</code> or
<code>log(4)/1.96</code> (larger uncertainty), other values are usually
not needed.</p>
<p>To specify the mean for the between-trial heterogeneities, one
typically assumes a specific degree of heterogeneity (cf. table below).
By default, <code>scenario_jointBLRM</code> assumes the mean to be
<code>log(0.25)</code> for the between-trial heterogeneity of <span class="math inline">\(log(\alpha_i)\)</span>, and
<code>log(0.125)</code> for the heterogeneity of the remaining
parameters. On natural (non-log) scale, this means that differences of
the parameters across trials are in median expected to be 0.25,
respectively 0.125. This is usually referred to as “moderate”
between-trial heterogeneity, other potential values for the mean can be
found in the following table.</p>
<table class="table">
<thead><tr class="header">
<th>Heterogeneity</th>
<th><span class="math inline">\(log(\alpha_i)\)</span></th>
<th>
<span class="math inline">\(log(\beta_i)\)</span> / <span class="math inline">\(\eta\)</span>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Small</td>
<td><code>log(0.125)</code></td>
<td><code>log(0.0625)</code></td>
</tr>
<tr class="even">
<td>Moderate</td>
<td><code>log(0.25)</code></td>
<td><code>log(0.125)</code></td>
</tr>
<tr class="odd">
<td>Substantial</td>
<td><code>log(0.5)</code></td>
<td><code>log(0.25)</code></td>
</tr>
<tr class="even">
<td>Large</td>
<td><code>log(1)</code></td>
<td><code>log(0.5)</code></td>
</tr>
</tbody>
</table>
<p>Regarding the prior setup for the between-trial heterogeneity, the
chosen prior should depend on the expected differences across trials and
the number of patients in the included co-data (larger number of
patients may require more heterogeneity to ensure sufficient
robustness). For many situations, the moderate and substantial
configurations from the above table provide acceptable robustness, so
that these are typically considered to be good starting points for prior
evaluations. Besides the evaluations of hypothetical scenarios and
simulations (covered in the following sections), prior effective sample
sizes also provide a good way of evaluating the influence of co-data on
the trial of interest and adjusting the priors for the between-trial
heterogeneity accordingly. Refer to <span class="citation">(Neuenschwander et al. 2020)</span> for more detail on
this type of method for assessing the information included in the
prior.</p>
</div>
</div>
<div class="section level3">
<h3 id="using-scenario_jointblrm-to-evaluate-hypothetical-data-scenarios">Using <code>scenario_jointBLRM</code> to evaluate hypothetical data
scenarios<a class="anchor" aria-label="anchor" href="#using-scenario_jointblrm-to-evaluate-hypothetical-data-scenarios"></a>
</h3>
<p>Hypothetical data scenarios evaluate the decisions of the BLRM in a
number of concrete situations that might occur in the trial that is
planned. While one can usually not foresee and evaluate all possible
situations (mostly due to there being too many of them), one restricts
these evaluations to important classes of settings. These include but
are not limited to:</p>
<ul>
<li><p>Early scenarios that assess the decisions within the first few
cohorts of a trial, especially scenarios that assume early
DLTs.</p></li>
<li><p>Late scenarios that assess the resulting MTD estimates based on
the planned number of patients (or slightly fewer).</p></li>
<li><p>Scenarios that assess specific critical dosing recommendations,
e.g. whether the escalation rule ceases to increase the dose when
observing certain DLT rates.</p></li>
<li><p>Scenarios that assume heterogeneous co-data. Here, it is
e.g. assessed whether the decision rule can correctly decide in settings
where the involved trials or trials show substantially different
toxicities.</p></li>
<li><p>Similarly to the previous point, if multiple parallel trials are
involved that start at different points in time, it should be assessed
how the co-data influences the start of the trials. For instance, it can
happen that the combination trial is not allowed to be started at the
planned starting dose due to toxic monotherapy data. It should therefore
be assessed (and aligned with ones recommendations) which co-data is
needed to allow the planned starting dose, and in which cases this would
not be recommended by the model.</p></li>
</ul>
<p>As an example, consider the scenario that the first cohort of 3
patients was treated at the dose 0.1 of compound 1 and a second cohort
at the dose 0.2. We assume further that no DLT occurred in the first
cohort, while one of the patients of the second cohort experienced DLT.
This translates to the data scenario:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scenario1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  dose1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.1</span>,  <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  dose2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,</span>
<span>  n.pat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">3</span>,    <span class="fl">3</span><span class="op">)</span>,</span>
<span>  n.dlt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">1</span><span class="op">)</span>,</span>
<span>  trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,  <span class="st">"A"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note that <code>"A"</code> was used as trial name for the monotherapy
trial for compound 1, as this needs to match the name specified in the
<code>trials.of.interest</code> argument.</p>
<p>Now, the scenario function can be called. Using the previously
specified objects, the function can be applied via</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scenario_jointBLRM.html">scenario_jointBLRM</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">scenario1</span>,</span>
<span>  historical.data <span class="op">=</span> <span class="va">historical.data</span>,</span>
<span>  doses.of.interest <span class="op">=</span> <span class="va">doses.of.interest</span>,</span>
<span>  dose.ref1 <span class="op">=</span> <span class="va">dose.ref1</span>,</span>
<span>  dose.ref2 <span class="op">=</span> <span class="va">dose.ref2</span>,</span>
<span>  trials.of.interest <span class="op">=</span> <span class="va">trials.of.interest</span>,</span>
<span>  types.of.interest <span class="op">=</span> <span class="va">types.of.interest</span>,</span>
<span>  prior.mu <span class="op">=</span> <span class="va">prior.mu</span>,</span>
<span>  prior.tau <span class="op">=</span> <span class="va">prior.tau</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result1</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`trial-A`</span></span>
<span><span class="co">#&gt;          mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+0 0.11859 0.11397 0.00277 0.08298 0.42437     0.73012        0.20692     0.06296</span></span>
<span><span class="co">#&gt; 0.2+0 0.16858 0.14123 0.00622 0.13118 0.52599     0.57770        0.28426     0.13804</span></span>
<span><span class="co">#&gt; 0.4+0 0.23990 0.18077 0.01177 0.19979 0.66828     0.41439        0.30802     0.27759</span></span>
<span><span class="co">#&gt; 0.8+0 0.32845 0.22607 0.01943 0.28842 0.82258     0.28763        0.27302     0.43935</span></span>
<span><span class="co">#&gt; 1.6+0 0.42193 0.26338 0.02855 0.39217 0.92793     0.19970        0.22465     0.57565</span></span>
<span><span class="co">#&gt; 2.4+0 0.47413 0.27850 0.03468 0.45659 0.96162     0.16412        0.19714     0.63874</span></span>
<span><span class="co">#&gt; 3.6+0 0.52269 0.28863 0.04127 0.52290 0.98040     0.13637        0.17219     0.69144</span></span>
<span><span class="co">#&gt; 5+0   0.55892 0.29362 0.04641 0.57564 0.98885     0.11860        0.15342     0.72798</span></span>
<span><span class="co">#&gt; 6+0   0.57778 0.29531 0.04980 0.60451 0.99195     0.11001        0.14404     0.74595</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`trial-B`</span></span>
<span><span class="co">#&gt;           mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+8  0.18629 0.13531 0.02394 0.15155 0.53989     0.52862        0.33361     0.13777</span></span>
<span><span class="co">#&gt; 0.2+8  0.23094 0.15907 0.03199 0.19187 0.63372     0.40750        0.36679     0.22571</span></span>
<span><span class="co">#&gt; 0.4+8  0.29299 0.18960 0.04220 0.25081 0.74998     0.28991        0.35425     0.35584</span></span>
<span><span class="co">#&gt; 0.8+8  0.37122 0.22352 0.05499 0.33055 0.86179     0.19460        0.30452     0.50088</span></span>
<span><span class="co">#&gt; 1.6+8  0.45729 0.25390 0.06750 0.43033 0.94195     0.13229        0.24075     0.62696</span></span>
<span><span class="co">#&gt; 2.4+8  0.50649 0.26808 0.07326 0.49341 0.96861     0.11074        0.20394     0.68532</span></span>
<span><span class="co">#&gt; 3.6+8  0.55217 0.27991 0.07487 0.55814 0.98426     0.09771        0.17248     0.72981</span></span>
<span><span class="co">#&gt; 5+8    0.58535 0.28891 0.07207 0.61212 0.99170     0.09375        0.15140     0.75485</span></span>
<span><span class="co">#&gt; 6+8    0.60188 0.29425 0.06797 0.64102 0.99437     0.09407        0.14083     0.76510</span></span>
<span><span class="co">#&gt; 0.1+12 0.22163 0.13567 0.04560 0.19111 0.56602     0.39149        0.42356     0.18495</span></span>
<span><span class="co">#&gt; 0.2+12 0.26436 0.15705 0.05503 0.23029 0.65521     0.29229        0.42656     0.28115</span></span>
<span><span class="co">#&gt; 0.4+12 0.32378 0.18514 0.06661 0.28640 0.76281     0.20083        0.38479     0.41438</span></span>
<span><span class="co">#&gt; 0.8+12 0.39874 0.21714 0.07997 0.36279 0.86979     0.13339        0.31136     0.55525</span></span>
<span><span class="co">#&gt; 1.6+12 0.48109 0.24729 0.09018 0.45862 0.94615     0.09510        0.23439     0.67051</span></span>
<span><span class="co">#&gt; 2.4+12 0.52780 0.26299 0.09012 0.52017 0.97151     0.08508        0.19534     0.71958</span></span>
<span><span class="co">#&gt; 3.6+12 0.57027 0.27851 0.08220 0.58428 0.98658     0.08529        0.16244     0.75227</span></span>
<span><span class="co">#&gt; 5+12   0.59971 0.29270 0.06724 0.63718 0.99349     0.09417        0.14046     0.76537</span></span>
<span><span class="co">#&gt; 6+12   0.61346 0.30184 0.05647 0.66692 0.99585     0.10270        0.12933     0.76797</span></span></code></pre></div>
<p>Note that the output contains two entries, one for each trial of
interest. As we previously specified the types of these trials, the
posterior toxicities of trial <code>"A"</code> are only computed for the
doses of interest that represent monotherapy with compound 1, while the
posteriors for trial <code>"B"</code> only contain the combination
therapy dose levels.</p>
<p>For each of these doses, the interval probabilities are computed, as
well as summary statistics of the posterior toxicities. By default, the
considered interval probabilities assume a target interval (range of DLT
rates considered to be appropriate as MTD) of <span class="math inline">\([0.16, 0.33)\)</span>. However, if one is
interested in some different interval, say, <span class="math inline">\([0.2, 0.3)\)</span>, this can be achieved by
supplying the optional argument
<code>dosing.intervals = c(0.2, 0.3)</code>. In this context, the
underdosing, respectively overdosing intervals contain the DLT rates
below, respectively above the target interval.</p>
<p>Further customization of the output can be achieved by supplying the
argument <code>probs</code>, which specifies the quantiles listed in the
output tables. By default, the reported quantiles are 2.5%, 50%, and
97.5%. If additional quantiles shall be computed, say, 25% and 75%, this
can be achieved e.g. with
<code>probs = c(0.025, 0.25, 0.5, 0.75, 0.975)</code>.</p>
<p>If additional output plots shall be created (not required for prior
evaluation, but potentially helpful for actual analyses), one can
activate this via <code>plot.decisions = TRUE</code>. Usually, simple
bar plots are created by this argument for monotherapy, and a heatmap
for combination therapy. By additionally setting
<code>plot.return = TRUE</code>, the plots will be contained in the
results list in the form of <code>ggplot</code> objects. Refer to the
documentation of the <code>ggplot2</code> package for detail on this
type of object. The <code>ggplot2</code> package also provides a broad
range of functions that can be used to customize the returned plots
further. If <code>plot.return</code> is not specified, the function will
only print the plots and potentially save them if the user specified a
path for outputs. Additionally, one may want to control the number of
digits the output is rounded to, especially when considering
heatmap-type plots for combination therapy, using
e.g. <code>digits = 3</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scenario_jointBLRM.html">scenario_jointBLRM</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">scenario1</span>,</span>
<span>  historical.data <span class="op">=</span> <span class="va">historical.data</span>,</span>
<span>  doses.of.interest <span class="op">=</span> <span class="va">doses.of.interest</span>,</span>
<span>  dose.ref1 <span class="op">=</span> <span class="va">dose.ref1</span>,</span>
<span>  dose.ref2 <span class="op">=</span> <span class="va">dose.ref2</span>,</span>
<span>  trials.of.interest <span class="op">=</span> <span class="va">trials.of.interest</span>,</span>
<span>  types.of.interest <span class="op">=</span> <span class="va">types.of.interest</span>,</span>
<span>  prior.mu <span class="op">=</span> <span class="va">prior.mu</span>,</span>
<span>  prior.tau <span class="op">=</span> <span class="va">prior.tau</span>,</span>
<span>  plot.decisions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot.return <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ewoc.threshold <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The generated plots are shown in the plot panel in RStudio. To
explicitly display the returned <code>ggplot</code> objects, one can
access them as follows.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result1a</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="st">"trial-A"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="../reference/figures/scenario-plots-1.png" alt=""><p class="caption">Plot generated by <code><a href="../reference/scenario_jointBLRM.html">scenario_jointBLRM()</a></code>
for trial <code>"A"</code></p>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result1a</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="st">"trial-B"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="../reference/figures/scenario-plots-2.png" alt=""><p class="caption">Plot generated by <code><a href="../reference/scenario_jointBLRM.html">scenario_jointBLRM()</a></code>
for trial <code>"B"</code></p>
</div>
<p>Note that we supplied an additional argument,
<code>ewoc.threshold</code>, to the call to
<code>scenario_jointBLRM</code>. This argument states the feasibility
bound of the EWOC criterion (cf. Babb et al. (1998)) and is displayed by
the plots to indicate which doses are fulfilling the EWOC criterion (and
could be used for the next cohort). This argument is optional and
defaults to <code>0.25</code> if not specified, so that it is actually
not needed unless a different value shall be used as feasibility bound
of the EWOC criterion.</p>
<p>There are further options for customizing plots, e.g. to indicate
which type of plots is used for combination therapy trials (heatmap or
bar diagram). Detail on this and further arguments for the output plots
are specified in the documentation.</p>
<p>One can also enable automatic saving of the posterior summaries by
supplying the optional arguments <code>file.name</code> and
<code>path</code>. If the latter specifies a valid (writable) directory,
the output will be saved as <code>.xlsx</code> file under the specified
<code>file.name</code>. Additionally, one can save the output plots by
further specifying <code>plots.save = TRUE</code> (provided a valid
<code>path</code> and <code>file.name</code> were supplied). In this
case, it is recommended to specify the format of the output plots via
<code>plot.unit</code>, <code>plot.width</code>, and
<code>plot.height</code>. Refer to the documentation for detail on
this.</p>
</div>
<div class="section level3">
<h3 id="evaluating-multiple-scenarios-in-parallel">Evaluating multiple scenarios in parallel<a class="anchor" aria-label="anchor" href="#evaluating-multiple-scenarios-in-parallel"></a>
</h3>
<p>When setting up a prior, one will typically want to evaluate a number
of scenarios at once, but, as Bayesian computation tends to take
relatively long, this may be rather slow for e.g. 10 or more scenarios.
Additionally, one would need e.g. 10 (or more) calls to
<code>scenario_jointBLRM</code>, which may not be practical if the same
scenarios are repeatedly evaluated for slightly altered prior
specifications.</p>
<p>To provide slightly more convenience for these types of exercise, the
function <code>scenario_list_jointBLRM</code> allows to perform multiple
calls to <code>scenario_jointBLRM</code> in parallel for a list of data
scenarios, which both speeds up the computation and simplifies the
evaluation of a number of hypothetical settings. Please note that a
parallel backend needs to be registered to leverage the parallelization,
otherwise the function will be executed sequentially. An example is
provided below.</p>
<p>To use this, consider first a (numbered) list of data scenarios. This
is specified as a list of lists, where each sublist must be of the
format expected by the <code>data</code> argument of
<code>scenario_jointBLRM</code>. For instance, a list with 8 scenarios
could look like this:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data.list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span></span>
<span>  <span class="co">#Scenario 1</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    dose1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    dose2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    n.pat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    n.dlt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>  <span class="co">#Scenario 2</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    dose1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    dose2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    n.pat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    n.dlt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>  <span class="co">#Scenario 3</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    dose1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    dose2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    n.pat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    n.dlt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>  <span class="co">#Scenario 4</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    dose1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.1</span>,  <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>    dose2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,</span>
<span>    n.pat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">3</span>,    <span class="fl">3</span><span class="op">)</span>,</span>
<span>    n.dlt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">1</span><span class="op">)</span>,</span>
<span>    trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,  <span class="st">"A"</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>  <span class="co">#Scenario 5</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    dose1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.1</span>,  <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>    dose2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,</span>
<span>    n.pat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">3</span>,    <span class="fl">3</span><span class="op">)</span>,</span>
<span>    n.dlt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">2</span><span class="op">)</span>,</span>
<span>    trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,  <span class="st">"A"</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>  <span class="co">#Scenario 6</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    dose1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.1</span>,  <span class="fl">0.2</span>,  <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    dose2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,</span>
<span>    n.pat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">3</span>,    <span class="fl">3</span>,    <span class="fl">3</span><span class="op">)</span>,</span>
<span>    n.dlt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">1</span><span class="op">)</span>,</span>
<span>    trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,  <span class="st">"A"</span>,  <span class="st">"A"</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>  <span class="co">#Scenario 7</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    dose1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.1</span>,  <span class="fl">0.2</span>,  <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    dose2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span><span class="op">)</span>,</span>
<span>    n.pat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">3</span>,    <span class="fl">3</span>,    <span class="fl">6</span><span class="op">)</span>,</span>
<span>    n.dlt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">1</span><span class="op">)</span>,</span>
<span>    trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,  <span class="st">"A"</span>,  <span class="st">"A"</span><span class="op">)</span><span class="op">)</span>,</span>
<span></span>
<span>  <span class="co">#Scenario 8</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    dose1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.1</span>,  <span class="fl">0.2</span>,  <span class="fl">0.4</span>,     <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>    dose2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">0</span>,       <span class="fl">8</span><span class="op">)</span>,</span>
<span>    n.pat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">3</span>,    <span class="fl">3</span>,    <span class="fl">6</span>,       <span class="fl">3</span><span class="op">)</span>,</span>
<span>    n.dlt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,    <span class="fl">0</span>,    <span class="fl">1</span>,       <span class="fl">0</span><span class="op">)</span>,</span>
<span>    trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,  <span class="st">"A"</span>,  <span class="st">"A"</span>,     <span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note that Scenario 8 also contains cohorts from the combination
therapy trial, encoded with the trial name <code>"B"</code> as specified
previously. The cohorts can be given in arbitrary order.</p>
<p>To run the evaluations in parallel, one can additionally register a
paralell backend. There are various existing packages than can achieve
this. A basic construct to register a parallel backend using the
<code>doFuture</code> package is the following</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://doFuture.futureverse.org" class="external-link">doFuture</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#specify number of cores -- here, only 1 for a sequential exacution</span></span>
<span><span class="va">n.cores</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co">#register backend for parallel execution and plan multisession</span></span>
<span><span class="fu">doFuture</span><span class="fu">::</span><span class="fu">registerDoFuture</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu">plan</span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va">multisession</span>, workers<span class="op">=</span><span class="va">n.cores</span><span class="op">)</span></span></code></pre></div>
<p>In this example, only 1 core is selected, which is identical to a
sequential execution. In practice, <code>n.cores</code> can be set
depending on the available processor on which the function is
running.</p>
<p>Now, coming back to the evaluation of scenarios, after registration
of the parallel backend one can simply use</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scenario_list_jointBLRM.html">scenario_list_jointBLRM</a></span><span class="op">(</span></span>
<span>  data.list <span class="op">=</span> <span class="va">data.list</span>,</span>
<span></span>
<span>  historical.data <span class="op">=</span> <span class="va">historical.data</span>,</span>
<span>  doses.of.interest <span class="op">=</span> <span class="va">doses.of.interest</span>,</span>
<span>  dose.ref1 <span class="op">=</span> <span class="va">dose.ref1</span>,</span>
<span>  dose.ref2 <span class="op">=</span> <span class="va">dose.ref2</span>,</span>
<span>  trials.of.interest <span class="op">=</span> <span class="va">trials.of.interest</span>,</span>
<span>  types.of.interest <span class="op">=</span> <span class="va">types.of.interest</span>,</span>
<span>  prior.mu <span class="op">=</span> <span class="va">prior.mu</span>,</span>
<span>  prior.tau <span class="op">=</span> <span class="va">prior.tau</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$`trial-A`</span></span>
<span><span class="co">#&gt;          mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+0 0.02629 0.06901 0.00000 0.00108 0.24157     0.95389        0.03335     0.01276</span></span>
<span><span class="co">#&gt; 0.2+0 0.03834 0.09010 0.00000 0.00245 0.32889     0.92537        0.04987     0.02476</span></span>
<span><span class="co">#&gt; 0.4+0 0.05776 0.12113 0.00000 0.00562 0.45832     0.88396        0.06689     0.04915</span></span>
<span><span class="co">#&gt; 0.8+0 0.08879 0.16322 0.00000 0.01303 0.62015     0.82253        0.08784     0.08963</span></span>
<span><span class="co">#&gt; 1.6+0 0.13789 0.21527 0.00000 0.03152 0.79474     0.73684        0.10943     0.15373</span></span>
<span><span class="co">#&gt; 2.4+0 0.17913 0.24919 0.00004 0.05380 0.87765     0.67021        0.12268     0.20711</span></span>
<span><span class="co">#&gt; 3.6+0 0.23398 0.28456 0.00024 0.09469 0.93795     0.58855        0.13350     0.27795</span></span>
<span><span class="co">#&gt; 5+0   0.29191 0.31325 0.00068 0.15226 0.96966     0.50889        0.13965     0.35146</span></span>
<span><span class="co">#&gt; 6+0   0.33007 0.32909 0.00101 0.19635 0.98156     0.46268        0.14039     0.39693</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$`trial-B`</span></span>
<span><span class="co">#&gt;           mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+8  0.09596 0.09113 0.00620 0.07103 0.34521     0.84208        0.12950     0.02842</span></span>
<span><span class="co">#&gt; 0.2+8  0.10744 0.10718 0.00681 0.07642 0.41522     0.80799        0.14739     0.04462</span></span>
<span><span class="co">#&gt; 0.4+8  0.12558 0.13146 0.00777 0.08460 0.52825     0.76176        0.16513     0.07311</span></span>
<span><span class="co">#&gt; 0.8+8  0.15440 0.16589 0.00922 0.09715 0.67305     0.69641        0.18429     0.11930</span></span>
<span><span class="co">#&gt; 1.6+8  0.20040 0.21082 0.01139 0.11942 0.82493     0.60701        0.20309     0.18990</span></span>
<span><span class="co">#&gt; 2.4+8  0.23946 0.24139 0.01301 0.14203 0.89541     0.53991        0.21173     0.24836</span></span>
<span><span class="co">#&gt; 3.6+8  0.29194 0.27425 0.01475 0.18147 0.94769     0.46073        0.21295     0.32632</span></span>
<span><span class="co">#&gt; 5+8    0.34776 0.30211 0.01600 0.23634 0.97595     0.38990        0.20507     0.40503</span></span>
<span><span class="co">#&gt; 6+8    0.38430 0.31780 0.01583 0.28020 0.98621     0.35231        0.19340     0.45429</span></span>
<span><span class="co">#&gt; 0.1+12 0.13536 0.09759 0.02351 0.11183 0.39383     0.70603        0.24972     0.04425</span></span>
<span><span class="co">#&gt; 0.2+12 0.14637 0.11139 0.02459 0.11774 0.45308     0.67355        0.26217     0.06428</span></span>
<span><span class="co">#&gt; 0.4+12 0.16381 0.13303 0.02590 0.12662 0.55511     0.62862        0.27497     0.09641</span></span>
<span><span class="co">#&gt; 0.8+12 0.19172 0.16481 0.02752 0.14010 0.69082     0.56756        0.28587     0.14657</span></span>
<span><span class="co">#&gt; 1.6+12 0.23685 0.20790 0.02896 0.16430 0.83609     0.48787        0.28715     0.22498</span></span>
<span><span class="co">#&gt; 2.4+12 0.27570 0.23836 0.02865 0.18959 0.90570     0.43039        0.27716     0.29245</span></span>
<span><span class="co">#&gt; 3.6+12 0.32825 0.27247 0.02611 0.23329 0.95521     0.36841        0.25258     0.37901</span></span>
<span><span class="co">#&gt; 5+12   0.38362 0.30255 0.02177 0.29273 0.98051     0.32100        0.21730     0.46170</span></span>
<span><span class="co">#&gt; 6+12   0.41912 0.31983 0.01832 0.33906 0.98942     0.29912        0.19269     0.50819</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [[2]]$`trial-A`</span></span>
<span><span class="co">#&gt;          mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+0 0.26814 0.20897 0.00921 0.21871 0.75773     0.39043        0.27542     0.33415</span></span>
<span><span class="co">#&gt; 0.2+0 0.33265 0.22806 0.01631 0.29563 0.81783     0.28592        0.26153     0.45255</span></span>
<span><span class="co">#&gt; 0.4+0 0.40530 0.24731 0.02576 0.38520 0.87830     0.20253        0.22777     0.56970</span></span>
<span><span class="co">#&gt; 0.8+0 0.47981 0.26293 0.03805 0.48000 0.93033     0.14415        0.18695     0.66890</span></span>
<span><span class="co">#&gt; 1.6+0 0.55030 0.27216 0.05140 0.57280 0.96564     0.10492        0.14716     0.74792</span></span>
<span><span class="co">#&gt; 2.4+0 0.58816 0.27448 0.06003 0.62448 0.97871     0.08794        0.12830     0.78376</span></span>
<span><span class="co">#&gt; 3.6+0 0.62306 0.27480 0.06955 0.67288 0.98712     0.07452        0.11243     0.81305</span></span>
<span><span class="co">#&gt; 5+0   0.64911 0.27379 0.07744 0.70944 0.99158     0.06503        0.10179     0.83318</span></span>
<span><span class="co">#&gt; 6+0   0.66271 0.27281 0.08181 0.72818 0.99340     0.06048        0.09647     0.84305</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]$`trial-B`</span></span>
<span><span class="co">#&gt;           mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+8  0.31803 0.21200 0.03883 0.27016 0.80618     0.27978        0.31595     0.40427</span></span>
<span><span class="co">#&gt; 0.2+8  0.37464 0.22757 0.04989 0.33596 0.85582     0.20259        0.28851     0.50890</span></span>
<span><span class="co">#&gt; 0.4+8  0.43947 0.24221 0.06374 0.41743 0.90237     0.14130        0.24416     0.61454</span></span>
<span><span class="co">#&gt; 0.8+8  0.50804 0.25388 0.07906 0.50597 0.94239     0.09733        0.19520     0.70747</span></span>
<span><span class="co">#&gt; 1.6+8  0.57453 0.26152 0.09346 0.59612 0.97093     0.07000        0.15119     0.77881</span></span>
<span><span class="co">#&gt; 2.4+8  0.61022 0.26465 0.09964 0.64633 0.98202     0.06004        0.13095     0.80901</span></span>
<span><span class="co">#&gt; 3.6+8  0.64223 0.26795 0.10260 0.69411 0.98938     0.05503        0.11411     0.83086</span></span>
<span><span class="co">#&gt; 5+8    0.66457 0.27211 0.09871 0.73061 0.99358     0.05467        0.10394     0.84139</span></span>
<span><span class="co">#&gt; 6+8    0.67519 0.27561 0.09326 0.74971 0.99529     0.05674        0.09900     0.84426</span></span>
<span><span class="co">#&gt; 0.1+12 0.34760 0.20579 0.06406 0.30474 0.81568     0.19935        0.34391     0.45674</span></span>
<span><span class="co">#&gt; 0.2+12 0.40176 0.22017 0.07626 0.36739 0.86299     0.14068        0.29892     0.56040</span></span>
<span><span class="co">#&gt; 0.4+12 0.46378 0.23381 0.09166 0.44455 0.90747     0.09630        0.24390     0.65980</span></span>
<span><span class="co">#&gt; 0.8+12 0.52930 0.24507 0.10814 0.52884 0.94589     0.06590        0.18934     0.74476</span></span>
<span><span class="co">#&gt; 1.6+12 0.59243 0.25375 0.11766 0.61408 0.97316     0.04924        0.14498     0.80578</span></span>
<span><span class="co">#&gt; 2.4+12 0.62561 0.25906 0.11782 0.66298 0.98376     0.04668        0.12468     0.82864</span></span>
<span><span class="co">#&gt; 3.6+12 0.65406 0.26685 0.10897 0.70973 0.99105     0.04985        0.11017     0.83998</span></span>
<span><span class="co">#&gt; 5+12   0.67204 0.27716 0.09146 0.74623 0.99504     0.05885        0.10170     0.83945</span></span>
<span><span class="co">#&gt; 6+12   0.67941 0.28518 0.07847 0.76665 0.99662     0.06699        0.09851     0.83450</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [[3]]$`trial-A`</span></span>
<span><span class="co">#&gt;          mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+0 0.55392 0.23487 0.10672 0.56626 0.94450     0.05423        0.14813     0.79764</span></span>
<span><span class="co">#&gt; 0.2+0 0.62100 0.22417 0.15080 0.65006 0.95843     0.02823        0.09791     0.87386</span></span>
<span><span class="co">#&gt; 0.4+0 0.68267 0.21360 0.19681 0.72473 0.97135     0.01569        0.06323     0.92108</span></span>
<span><span class="co">#&gt; 0.8+0 0.73574 0.20305 0.24131 0.78820 0.98240     0.00966        0.04240     0.94794</span></span>
<span><span class="co">#&gt; 1.6+0 0.77960 0.19223 0.28604 0.83776 0.99039     0.00650        0.02952     0.96398</span></span>
<span><span class="co">#&gt; 2.4+0 0.80132 0.18580 0.30996 0.86165 0.99352     0.00502        0.02416     0.97082</span></span>
<span><span class="co">#&gt; 3.6+0 0.82049 0.17938 0.33431 0.88245 0.99573     0.00419        0.02007     0.97574</span></span>
<span><span class="co">#&gt; 5+0   0.83435 0.17421 0.35317 0.89696 0.99698     0.00354        0.01748     0.97898</span></span>
<span><span class="co">#&gt; 6+0   0.84146 0.17137 0.36365 0.90436 0.99751     0.00331        0.01605     0.98064</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]$`trial-B`</span></span>
<span><span class="co">#&gt;           mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+8  0.57010 0.23870 0.11961 0.58521 0.95411     0.04638        0.14664     0.80698</span></span>
<span><span class="co">#&gt; 0.2+8  0.63093 0.22772 0.16315 0.66154 0.96590     0.02378        0.10065     0.87557</span></span>
<span><span class="co">#&gt; 0.4+8  0.68930 0.21501 0.20934 0.73289 0.97661     0.01234        0.06433     0.92333</span></span>
<span><span class="co">#&gt; 0.8+8  0.74132 0.20229 0.25455 0.79378 0.98518     0.00676        0.04188     0.95136</span></span>
<span><span class="co">#&gt; 1.6+8  0.78449 0.19122 0.29550 0.84357 0.99171     0.00438        0.02938     0.96624</span></span>
<span><span class="co">#&gt; 2.4+8  0.80505 0.18657 0.31334 0.86802 0.99443     0.00392        0.02481     0.97127</span></span>
<span><span class="co">#&gt; 3.6+8  0.82157 0.18479 0.32088 0.88878 0.99649     0.00436        0.02253     0.97311</span></span>
<span><span class="co">#&gt; 5+8    0.83121 0.18717 0.31122 0.90422 0.99773     0.00536        0.02350     0.97114</span></span>
<span><span class="co">#&gt; 6+8    0.83470 0.19080 0.29669 0.91165 0.99826     0.00665        0.02486     0.96849</span></span>
<span><span class="co">#&gt; 0.1+12 0.58885 0.22947 0.15101 0.60400 0.95623     0.02908        0.13299     0.83793</span></span>
<span><span class="co">#&gt; 0.2+12 0.64701 0.21878 0.19374 0.67685 0.96746     0.01465        0.08733     0.89802</span></span>
<span><span class="co">#&gt; 0.4+12 0.70278 0.20659 0.23872 0.74507 0.97759     0.00718        0.05475     0.93807</span></span>
<span><span class="co">#&gt; 0.8+12 0.75226 0.19485 0.28069 0.80306 0.98590     0.00414        0.03481     0.96105</span></span>
<span><span class="co">#&gt; 1.6+12 0.79252 0.18624 0.31502 0.85126 0.99229     0.00310        0.02563     0.97127</span></span>
<span><span class="co">#&gt; 2.4+12 0.81058 0.18486 0.32065 0.87471 0.99499     0.00347        0.02347     0.97306</span></span>
<span><span class="co">#&gt; 3.6+12 0.82312 0.18922 0.30377 0.89506 0.99708     0.00524        0.02505     0.96971</span></span>
<span><span class="co">#&gt; 5+12   0.82759 0.19985 0.26604 0.90954 0.99824     0.00897        0.02914     0.96189</span></span>
<span><span class="co">#&gt; 6+12   0.82713 0.20955 0.23260 0.91701 0.99876     0.01278        0.03287     0.95435</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [[4]]$`trial-A`</span></span>
<span><span class="co">#&gt;          mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+0 0.11867 0.11368 0.00285 0.08317 0.42156     0.72987        0.20847     0.06166</span></span>
<span><span class="co">#&gt; 0.2+0 0.16832 0.14058 0.00634 0.13091 0.52177     0.57767        0.28551     0.13682</span></span>
<span><span class="co">#&gt; 0.4+0 0.23900 0.17944 0.01193 0.19939 0.66692     0.41518        0.30962     0.27520</span></span>
<span><span class="co">#&gt; 0.8+0 0.32700 0.22415 0.01969 0.28785 0.82070     0.28735        0.27547     0.43718</span></span>
<span><span class="co">#&gt; 1.6+0 0.42030 0.26144 0.02924 0.39036 0.92652     0.19896        0.22597     0.57507</span></span>
<span><span class="co">#&gt; 2.4+0 0.47251 0.27665 0.03573 0.45497 0.96065     0.16300        0.19858     0.63842</span></span>
<span><span class="co">#&gt; 3.6+0 0.52117 0.28686 0.04252 0.52053 0.97972     0.13457        0.17341     0.69202</span></span>
<span><span class="co">#&gt; 5+0   0.55754 0.29191 0.04842 0.57293 0.98840     0.11601        0.15508     0.72891</span></span>
<span><span class="co">#&gt; 6+0   0.57648 0.29364 0.05186 0.60143 0.99151     0.10739        0.14621     0.74640</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]$`trial-B`</span></span>
<span><span class="co">#&gt;           mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+8  0.18628 0.13471 0.02386 0.15218 0.53638     0.52684        0.33541     0.13775</span></span>
<span><span class="co">#&gt; 0.2+8  0.23069 0.15834 0.03157 0.19210 0.63125     0.40788        0.36582     0.22630</span></span>
<span><span class="co">#&gt; 0.4+8  0.29222 0.18850 0.04234 0.24976 0.74582     0.28848        0.35725     0.35427</span></span>
<span><span class="co">#&gt; 0.8+8  0.36998 0.22202 0.05526 0.32964 0.85779     0.19335        0.30722     0.49943</span></span>
<span><span class="co">#&gt; 1.6+8  0.45580 0.25243 0.06800 0.42798 0.93786     0.13186        0.24138     0.62676</span></span>
<span><span class="co">#&gt; 2.4+8  0.50490 0.26668 0.07340 0.49072 0.96565     0.11014        0.20534     0.68452</span></span>
<span><span class="co">#&gt; 3.6+8  0.55053 0.27857 0.07551 0.55580 0.98266     0.09668        0.17413     0.72919</span></span>
<span><span class="co">#&gt; 5+8    0.58374 0.28762 0.07251 0.60975 0.99057     0.09245        0.15219     0.75536</span></span>
<span><span class="co">#&gt; 6+8    0.60032 0.29299 0.06827 0.63837 0.99357     0.09346        0.14078     0.76576</span></span>
<span><span class="co">#&gt; 0.1+12 0.22155 0.13495 0.04615 0.19109 0.56234     0.38986        0.42474     0.18540</span></span>
<span><span class="co">#&gt; 0.2+12 0.26404 0.15625 0.05524 0.22990 0.65119     0.29205        0.42655     0.28140</span></span>
<span><span class="co">#&gt; 0.4+12 0.32295 0.18402 0.06725 0.28584 0.75831     0.19990        0.38786     0.41224</span></span>
<span><span class="co">#&gt; 0.8+12 0.39743 0.21564 0.08076 0.36222 0.86533     0.13197        0.31501     0.55302</span></span>
<span><span class="co">#&gt; 1.6+12 0.47953 0.24583 0.09131 0.45613 0.94205     0.09378        0.23702     0.66920</span></span>
<span><span class="co">#&gt; 2.4+12 0.52616 0.26162 0.09122 0.51759 0.96925     0.08418        0.19670     0.71912</span></span>
<span><span class="co">#&gt; 3.6+12 0.56861 0.27725 0.08313 0.58244 0.98505     0.08485        0.16344     0.75171</span></span>
<span><span class="co">#&gt; 5+12   0.59812 0.29156 0.06918 0.63659 0.99265     0.09321        0.14154     0.76525</span></span>
<span><span class="co">#&gt; 6+12   0.61195 0.30077 0.05775 0.66487 0.99528     0.10149        0.13108     0.76743</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; [[5]]$`trial-A`</span></span>
<span><span class="co">#&gt;          mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+0 0.24977 0.15939 0.02780 0.22110 0.62143     0.34596        0.37606     0.27798</span></span>
<span><span class="co">#&gt; 0.2+0 0.33372 0.17764 0.05234 0.31479 0.71227     0.18186        0.34897     0.46917</span></span>
<span><span class="co">#&gt; 0.4+0 0.43305 0.20155 0.08178 0.42542 0.82251     0.09285        0.24353     0.66362</span></span>
<span><span class="co">#&gt; 0.8+0 0.53212 0.22284 0.11275 0.53840 0.91761     0.05181        0.16035     0.78784</span></span>
<span><span class="co">#&gt; 1.6+0 0.61830 0.23384 0.14357 0.64406 0.96940     0.03166        0.10776     0.86058</span></span>
<span><span class="co">#&gt; 2.4+0 0.66103 0.23540 0.16184 0.69932 0.98398     0.02440        0.08762     0.88798</span></span>
<span><span class="co">#&gt; 3.6+0 0.69831 0.23419 0.17950 0.74859 0.99171     0.01909        0.07211     0.90880</span></span>
<span><span class="co">#&gt; 5+0   0.72486 0.23168 0.19371 0.78465 0.99524     0.01579        0.06265     0.92156</span></span>
<span><span class="co">#&gt; 6+0   0.73833 0.22983 0.20204 0.80272 0.99649     0.01458        0.05739     0.92803</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]$`trial-B`</span></span>
<span><span class="co">#&gt;           mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+8  0.30531 0.17914 0.05170 0.27246 0.72103     0.23654        0.37864     0.38482</span></span>
<span><span class="co">#&gt; 0.2+8  0.37687 0.19477 0.07589 0.35207 0.79578     0.13470        0.32380     0.54150</span></span>
<span><span class="co">#&gt; 0.4+8  0.46261 0.20991 0.10754 0.45071 0.87398     0.06770        0.23520     0.69710</span></span>
<span><span class="co">#&gt; 0.8+8  0.55273 0.22218 0.14098 0.55828 0.93669     0.03485        0.15359     0.81156</span></span>
<span><span class="co">#&gt; 1.6+8  0.63459 0.22940 0.17217 0.66147 0.97464     0.02033        0.10184     0.87783</span></span>
<span><span class="co">#&gt; 2.4+8  0.67517 0.23175 0.18515 0.71663 0.98638     0.01719        0.08428     0.89853</span></span>
<span><span class="co">#&gt; 3.6+8  0.70923 0.23440 0.19008 0.76608 0.99316     0.01686        0.07215     0.91099</span></span>
<span><span class="co">#&gt; 5+8    0.73142 0.23858 0.18203 0.80303 0.99632     0.01876        0.06757     0.91367</span></span>
<span><span class="co">#&gt; 6+8    0.74133 0.24245 0.17331 0.82163 0.99746     0.02162        0.06618     0.91220</span></span>
<span><span class="co">#&gt; 0.1+12 0.33556 0.17496 0.07780 0.30647 0.73527     0.15761        0.39127     0.45112</span></span>
<span><span class="co">#&gt; 0.2+12 0.40400 0.18910 0.10365 0.38218 0.80682     0.08480        0.31265     0.60255</span></span>
<span><span class="co">#&gt; 0.4+12 0.48600 0.20300 0.13593 0.47605 0.88037     0.04084        0.21272     0.74644</span></span>
<span><span class="co">#&gt; 0.8+12 0.57204 0.21483 0.16929 0.57851 0.94061     0.02066        0.13542     0.84392</span></span>
<span><span class="co">#&gt; 1.6+12 0.64954 0.22356 0.19358 0.67816 0.97648     0.01398        0.09136     0.89466</span></span>
<span><span class="co">#&gt; 2.4+12 0.68696 0.22877 0.19789 0.73125 0.98777     0.01420        0.07767     0.90813</span></span>
<span><span class="co">#&gt; 3.6+12 0.71663 0.23699 0.18356 0.78005 0.99423     0.01835        0.07137     0.91028</span></span>
<span><span class="co">#&gt; 5+12   0.73360 0.24843 0.15551 0.81524 0.99711     0.02646        0.07069     0.90285</span></span>
<span><span class="co">#&gt; 6+12   0.73972 0.25748 0.13210 0.83393 0.99815     0.03410        0.07095     0.89495</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; [[6]]$`trial-A`</span></span>
<span><span class="co">#&gt;          mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+0 0.05911 0.06818 0.00063 0.03493 0.24966     0.91423        0.07783     0.00794</span></span>
<span><span class="co">#&gt; 0.2+0 0.09033 0.08776 0.00215 0.06284 0.32539     0.82261        0.15384     0.02355</span></span>
<span><span class="co">#&gt; 0.4+0 0.14489 0.12307 0.00565 0.11133 0.45913     0.64384        0.26451     0.09165</span></span>
<span><span class="co">#&gt; 0.8+0 0.23176 0.18129 0.01172 0.18675 0.67629     0.43971        0.30121     0.25908</span></span>
<span><span class="co">#&gt; 1.6+0 0.34174 0.24353 0.01977 0.29132 0.87424     0.28997        0.26181     0.44822</span></span>
<span><span class="co">#&gt; 2.4+0 0.40748 0.27144 0.02508 0.36426 0.94082     0.23060        0.22948     0.53992</span></span>
<span><span class="co">#&gt; 3.6+0 0.46949 0.29098 0.03067 0.44250 0.97390     0.18543        0.19892     0.61565</span></span>
<span><span class="co">#&gt; 5+0   0.51563 0.30114 0.03564 0.50778 0.98694     0.15717        0.17738     0.66545</span></span>
<span><span class="co">#&gt; 6+0   0.53948 0.30490 0.03865 0.54403 0.99138     0.14457        0.16604     0.68939</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]$`trial-B`</span></span>
<span><span class="co">#&gt;           mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+8  0.13106 0.09683 0.01567 0.10728 0.37996     0.70805        0.24788     0.04407</span></span>
<span><span class="co">#&gt; 0.2+8  0.16116 0.11591 0.02119 0.13268 0.46257     0.60029        0.31297     0.08674</span></span>
<span><span class="co">#&gt; 0.4+8  0.21043 0.14603 0.02984 0.17527 0.58846     0.45174        0.36967     0.17859</span></span>
<span><span class="co">#&gt; 0.8+8  0.28621 0.18952 0.04152 0.24147 0.75561     0.30389        0.35784     0.33827</span></span>
<span><span class="co">#&gt; 1.6+8  0.38493 0.23782 0.05464 0.33850 0.90060     0.19503        0.29274     0.51223</span></span>
<span><span class="co">#&gt; 2.4+8  0.44619 0.26221 0.06073 0.40829 0.95072     0.15516        0.24764     0.59720</span></span>
<span><span class="co">#&gt; 3.6+8  0.50464 0.28184 0.06339 0.48516 0.97848     0.13016        0.20631     0.66353</span></span>
<span><span class="co">#&gt; 5+8    0.54764 0.29489 0.06066 0.55205 0.98990     0.12065        0.17545     0.70390</span></span>
<span><span class="co">#&gt; 6+8    0.56929 0.30157 0.05736 0.58970 0.99353     0.11880        0.15963     0.72157</span></span>
<span><span class="co">#&gt; 0.1+12 0.16861 0.10178 0.03547 0.14699 0.42186     0.55455        0.37150     0.07395</span></span>
<span><span class="co">#&gt; 0.2+12 0.19744 0.11826 0.04245 0.17231 0.49480     0.45280        0.42021     0.12699</span></span>
<span><span class="co">#&gt; 0.4+12 0.24468 0.14532 0.05306 0.21371 0.61089     0.32741        0.43966     0.23293</span></span>
<span><span class="co">#&gt; 0.8+12 0.31742 0.18591 0.06541 0.27818 0.76967     0.21384        0.38958     0.39658</span></span>
<span><span class="co">#&gt; 1.6+12 0.41223 0.23284 0.07658 0.37137 0.90767     0.14039        0.29564     0.56397</span></span>
<span><span class="co">#&gt; 2.4+12 0.47085 0.25807 0.07755 0.44007 0.95526     0.11903        0.24141     0.63956</span></span>
<span><span class="co">#&gt; 3.6+12 0.52609 0.28065 0.07099 0.51750 0.98145     0.11237        0.19308     0.69455</span></span>
<span><span class="co">#&gt; 5+12   0.56553 0.29818 0.05881 0.58437 0.99198     0.11701        0.16055     0.72244</span></span>
<span><span class="co">#&gt; 6+12   0.58456 0.30825 0.04911 0.62246 0.99526     0.12328        0.14559     0.73113</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span>
<span><span class="co">#&gt; [[7]]$`trial-A`</span></span>
<span><span class="co">#&gt;          mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+0 0.04107 0.04924 0.00043 0.02345 0.17909     0.96468        0.03372     0.00160</span></span>
<span><span class="co">#&gt; 0.2+0 0.06287 0.06327 0.00156 0.04278 0.23383     0.91703        0.07808     0.00489</span></span>
<span><span class="co">#&gt; 0.4+0 0.10298 0.09030 0.00423 0.07765 0.33752     0.78440        0.18784     0.02776</span></span>
<span><span class="co">#&gt; 0.8+0 0.17426 0.14502 0.00872 0.13480 0.54760     0.57015        0.28477     0.14508</span></span>
<span><span class="co">#&gt; 1.6+0 0.27667 0.21783 0.01473 0.21921 0.80490     0.38519        0.28245     0.33236</span></span>
<span><span class="co">#&gt; 2.4+0 0.34253 0.25489 0.01879 0.28040 0.90423     0.30748        0.25768     0.43484</span></span>
<span><span class="co">#&gt; 3.6+0 0.40680 0.28307 0.02328 0.34997 0.95731     0.24851        0.22889     0.52260</span></span>
<span><span class="co">#&gt; 5+0   0.45561 0.29927 0.02711 0.41235 0.97881     0.21277        0.20469     0.58254</span></span>
<span><span class="co">#&gt; 6+0   0.48110 0.30597 0.02927 0.44877 0.98594     0.19524        0.19310     0.61166</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]$`trial-B`</span></span>
<span><span class="co">#&gt;           mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+8  0.11369 0.08215 0.01366 0.09462 0.32360     0.77678        0.20059     0.02263</span></span>
<span><span class="co">#&gt; 0.2+8  0.13562 0.09562 0.01829 0.11356 0.37909     0.69106        0.26402     0.04492</span></span>
<span><span class="co">#&gt; 0.4+8  0.17336 0.12013 0.02564 0.14466 0.48312     0.55616        0.34117     0.10267</span></span>
<span><span class="co">#&gt; 0.8+8  0.23644 0.16176 0.03527 0.19611 0.65544     0.39261        0.37683     0.23056</span></span>
<span><span class="co">#&gt; 1.6+8  0.32773 0.21739 0.04580 0.27414 0.84625     0.25927        0.33264     0.40809</span></span>
<span><span class="co">#&gt; 2.4+8  0.38855 0.24900 0.05067 0.33365 0.92292     0.20827        0.28655     0.50518</span></span>
<span><span class="co">#&gt; 3.6+8  0.44901 0.27590 0.05227 0.40395 0.96624     0.17497        0.23832     0.58671</span></span>
<span><span class="co">#&gt; 5+8    0.49494 0.29417 0.05008 0.46720 0.98430     0.15997        0.20190     0.63813</span></span>
<span><span class="co">#&gt; 6+8    0.51859 0.30336 0.04690 0.50519 0.99022     0.15582        0.18457     0.65961</span></span>
<span><span class="co">#&gt; 0.1+12 0.15221 0.08991 0.03285 0.13417 0.37594     0.61827        0.33582     0.04591</span></span>
<span><span class="co">#&gt; 0.2+12 0.17321 0.10106 0.03870 0.15281 0.42447     0.53061        0.39281     0.07658</span></span>
<span><span class="co">#&gt; 0.4+12 0.20941 0.12245 0.04733 0.18385 0.51609     0.41087        0.44202     0.14711</span></span>
<span><span class="co">#&gt; 0.8+12 0.27006 0.16073 0.05769 0.23394 0.67608     0.28076        0.42922     0.29002</span></span>
<span><span class="co">#&gt; 1.6+12 0.35803 0.21441 0.06621 0.31123 0.85821     0.18857        0.34417     0.46726</span></span>
<span><span class="co">#&gt; 2.4+12 0.41660 0.24654 0.06669 0.37020 0.93059     0.15941        0.28329     0.55730</span></span>
<span><span class="co">#&gt; 3.6+12 0.47438 0.27603 0.05989 0.44150 0.97139     0.14850        0.22411     0.62739</span></span>
<span><span class="co">#&gt; 5+12   0.51736 0.29837 0.04842 0.50651 0.98789     0.15118        0.18277     0.66605</span></span>
<span><span class="co">#&gt; 6+12   0.53878 0.31060 0.04001 0.54503 0.99295     0.15636        0.16319     0.68045</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt; [[8]]$`trial-A`</span></span>
<span><span class="co">#&gt;          mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+0 0.03306 0.04007 0.00032 0.01892 0.14553     0.98176        0.01781     0.00043</span></span>
<span><span class="co">#&gt; 0.2+0 0.05178 0.05267 0.00120 0.03502 0.19503     0.95110        0.04730     0.00160</span></span>
<span><span class="co">#&gt; 0.4+0 0.08759 0.07862 0.00340 0.06522 0.29536     0.84184        0.14363     0.01453</span></span>
<span><span class="co">#&gt; 0.8+0 0.15450 0.13497 0.00728 0.11586 0.51412     0.62893        0.26020     0.11087</span></span>
<span><span class="co">#&gt; 1.6+0 0.25497 0.21270 0.01266 0.19266 0.79321     0.43361        0.27358     0.29281</span></span>
<span><span class="co">#&gt; 2.4+0 0.32107 0.25277 0.01640 0.25071 0.90094     0.34750        0.25593     0.39657</span></span>
<span><span class="co">#&gt; 3.6+0 0.38635 0.28352 0.02024 0.31869 0.95758     0.28067        0.23195     0.48738</span></span>
<span><span class="co">#&gt; 5+0   0.43636 0.30143 0.02354 0.38032 0.97980     0.24004        0.20898     0.55098</span></span>
<span><span class="co">#&gt; 6+0   0.46261 0.30893 0.02567 0.41675 0.98673     0.22006        0.19818     0.58176</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]$`trial-B`</span></span>
<span><span class="co">#&gt;           mean      sd  q.2.5%   q.50% q.97.5% P([0,0.16)) P([0.16,0.33)) P([0.33,1])</span></span>
<span><span class="co">#&gt; 0.1+8  0.09138 0.06342 0.01104 0.07747 0.25118     0.86816        0.12625     0.00559</span></span>
<span><span class="co">#&gt; 0.2+8  0.10884 0.07303 0.01509 0.09309 0.29139     0.79879        0.18753     0.01368</span></span>
<span><span class="co">#&gt; 0.4+8  0.14135 0.09474 0.02144 0.12001 0.38402     0.66708        0.28553     0.04739</span></span>
<span><span class="co">#&gt; 0.8+8  0.20064 0.14033 0.03054 0.16548 0.57193     0.48151        0.36203     0.15646</span></span>
<span><span class="co">#&gt; 1.6+8  0.29220 0.20583 0.03981 0.23645 0.81067     0.32176        0.33846     0.33978</span></span>
<span><span class="co">#&gt; 2.4+8  0.35528 0.24340 0.04414 0.29253 0.90788     0.25585        0.29750     0.44665</span></span>
<span><span class="co">#&gt; 3.6+8  0.41885 0.27509 0.04554 0.35960 0.96243     0.21052        0.25397     0.53551</span></span>
<span><span class="co">#&gt; 5+8    0.46762 0.29589 0.04289 0.42272 0.98343     0.18912        0.21588     0.59500</span></span>
<span><span class="co">#&gt; 6+8    0.49297 0.30599 0.04019 0.46165 0.98977     0.18203        0.19545     0.62252</span></span>
<span><span class="co">#&gt; 0.1+12 0.12938 0.07330 0.02905 0.11540 0.30764     0.72073        0.26244     0.01683</span></span>
<span><span class="co">#&gt; 0.2+12 0.14614 0.08079 0.03421 0.13107 0.34354     0.63959        0.32973     0.03068</span></span>
<span><span class="co">#&gt; 0.4+12 0.17738 0.09910 0.04212 0.15809 0.42293     0.50796        0.41295     0.07909</span></span>
<span><span class="co">#&gt; 0.8+12 0.23449 0.14065 0.05171 0.20333 0.59697     0.35318        0.43979     0.20703</span></span>
<span><span class="co">#&gt; 1.6+12 0.32294 0.20356 0.05913 0.27372 0.82331     0.23534        0.36822     0.39644</span></span>
<span><span class="co">#&gt; 2.4+12 0.38392 0.24123 0.05927 0.32939 0.91729     0.19522        0.30568     0.49910</span></span>
<span><span class="co">#&gt; 3.6+12 0.44512 0.27499 0.05315 0.39748 0.96792     0.17594        0.24301     0.58105</span></span>
<span><span class="co">#&gt; 5+12   0.49138 0.29939 0.04260 0.46209 0.98670     0.17329        0.19647     0.63024</span></span>
<span><span class="co">#&gt; 6+12   0.51482 0.31231 0.03513 0.50208 0.99235     0.17616        0.17270     0.65114</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"rng")</span></span>
<span><span class="co">#&gt; attr(,"rng")[[1]]</span></span>
<span><span class="co">#&gt; [1]       10407  2133139108  -773071531  -244150766 -1207652757  1191582384  1240354545</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"doRNG_version")</span></span>
<span><span class="co">#&gt; [1] "1.7.4"</span></span></code></pre></div>
<p>Here, except for the first argument, <code>data.list</code>, we have
provided precisely the same arguments as for the call to
<code>scenario_jointBLRM</code> from the previous section. This would
also work for all other (optional) arguments of
<code>scenario_jointBLRM</code>, except for <code>file.name</code>.
Instead of this argument, <code>scenario_list_jointBLRM</code> uses the
optional argument <code>file.names</code> (notice the plural), which has
the same function as <code>file.name</code> for
<code>scenario_jointBLRM</code>, but needs to contain a vector with a
file name for each scenario instead. As before, the argument is ignored
unless you want to save the output and have supplied a
<code>path</code>.</p>
<p>Note further that the historical data provided to
<code>scenario_list_jointBLRM</code> is included in the posterior
evaluations for every scenario, i.e., the historical data is interpreted
in the same fashion as for <code>scenario_jointBLRM</code>, and does not
vary across the scenarios in the list.</p>
<p>To obtain a prior configuration, it is now recommended to create a
sufficiently large number of scenarios, and repeatedly evaluate the
scenarios to gradually alter the prior distribution and obtain an
appropriate setup and behavior in the considered scenarios. However, as
mentioned before, one will probably not be able to consider every
potential scenario in advance, so that this is mostly a heuristic check
and is not guaranteed to yield an optimal prior. Due to this, further
evaluation of the prior should be performed to confirm that it shows
appropriate operating characteristics in the long-run. This will be the
subject of the following section.</p>
</div>
</div>
<div class="section level2">
<h2 id="simulating-dose-finding-trials-with-sim_jointblrm">Simulating dose-finding trials with <code>sim_jointBLRM</code><a class="anchor" aria-label="anchor" href="#simulating-dose-finding-trials-with-sim_jointblrm"></a>
</h2>
<p>Simulations of trials usually aim to estimate the operating
characteristics (OC) of a dose-finding trial design, which includes
e.g. the ratio of MTDs declared on each dose (or on doses with DLT rate
in a specific dosing interval), the number of patients per dose and the
number of DLTs in the trial, as well as further metrics for the
simulation results.</p>
<p>To estimate the operating characteristics of the BLRM, one usually
uses simulated trials. That is, one assumes a fixed set of available
dose levels and a fixed dose-toxicity scenario – i.e. a specification of
the DLT rate for each available dose level – and simulates a number of
trials in this setting. This allows to e.g. estimate the average number
of MTDs in the correct interval or the number of patients treated at
overly toxic doses for this specific dose-toxicity scenario.</p>
<p>As it is of course not possible to test all possible dose-toxicity
scenarios, one will typically confine oneself to a selected number of
scenarios that illustrate different possible cases. These should usually
range from scenarios that follow the prior expectations, over more
extreme scenarios that assume the involved drugs to be considerably more
(or less) toxic than expected by the prior, up to scenarios that
deliberately assume the trials to result in heterogeneous data or that
the true dose-toxicity relationship does not follow the logistic model
of the BLRM (i.e. one assumes the BLRM to be misspecified).</p>
<p>As an example how such simulations can be performed via
<code>sim_jointBLRM</code>, we will again consider the setting of the
previous section. For this, recall that a monotherapy and combination
therapy trial shall run (partially) in parallel, where we wanted to
consider the dose levels given in the variable
<code>doses.of.interest</code> and use the data from a historical trial
as given in the <code>historical.data</code> argument.</p>
<p>The function <code>sim_jointBLRM</code> supports simulation of
(parallel) monotherapy or combination therapy trials. Internally, it is
differentiated between three types, namely monotherapy for compound 1
(<code>"mono1"</code>), monotherapy for compound 2
(<code>"mono2"</code>), and combination therapy with compounds 1 and 2
(<code>"combi"</code>). For each of these types, the function can
actively simulate 2 trials (i.e., six parallel trials in total), and the
order in which cohorts are enrolled in each of the up to six trials can
be specified freely. The simulated trials can be activated independently
of each other, i.e. one can choose how many of the parallel trials are
simulated.</p>
<p>Additionally, historical data from arbitrarily many trials that are
already concluded can be given, and furthermore, data that was observed
in the actively simulated trials before the start of the simulation can
be included as well (which allows to simulate how one or more trials
might continue after already having observed a specific data
scenario).</p>
<div class="section level3">
<h3 id="naming-conventions-for-sim_jointblrm">Naming conventions for <code>sim_jointBLRM</code><a class="anchor" aria-label="anchor" href="#naming-conventions-for-sim_jointblrm"></a>
</h3>
<p>The function features a large number of optional parameters to allow
relatively flexible customization of the simulated trials,
e.g. regarding the number of patients per cohort, criteria for MTD
selection, escalation rules, and further topics. Refer to the
documentation for more detail and the parameters that are not discussed
in this vignette.</p>
<p>To allow some settings to deviate across the simulated trials, many
of the arguments of <code>sim_jointBLRM</code> exist in six variations,
one for each simulated trial. To differentiate between these, the
arguments feature trial-specific suffixes as given in the following
table.</p>
<table class="table">
<thead><tr class="header">
<th>Trial</th>
<th align="center">Suffix of function arguments</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1st monotherapy trial for compound 1</td>
<td align="center"><code>mono1.a</code></td>
</tr>
<tr class="even">
<td>1st monotherapy trial for compound 2</td>
<td align="center"><code>mono2.a</code></td>
</tr>
<tr class="odd">
<td>1st combination therapy trial</td>
<td align="center"><code>combi.a</code></td>
</tr>
<tr class="even">
<td>2nd monotherapy trial for compound 1</td>
<td align="center"><code>mono1.b</code></td>
</tr>
<tr class="odd">
<td>2nd monotherapy trial for compound 2</td>
<td align="center"><code>mono2.b</code></td>
</tr>
<tr class="even">
<td>2nd combination therapy trial</td>
<td align="center"><code>combi.b</code></td>
</tr>
</tbody>
</table>
<p>Here, the first and second trial for a specific trial type mean
simply that these are independently escalating trials of the same type,
but does not imply a specific order or some other dependency across the
first and second trial (except that they are jointly modeled in the
BLRM). It is for instance possible to just simulate the
<code>mono2.b</code> trial and deactivate all other trials.</p>
<p>The take away message from these naming conventions is that one needs
to use the parameter with the corresponding suffix when an specific
option shall only affect one specific trial but not the others.
Arguments that do not have a suffix will in general always affect all
simulated trials.</p>
<p>Apart from the argument names, the suffixes for the six potentially
simulated trials are also used to refer to the corresponding trial when
the order in which the trials enroll cohorts is specified. Furthermore,
they are also used to encode the trials when historical data that was
previously recorded in an actively simulated trial shall be included.
Refer to the documentation for more detail.</p>
</div>
<div class="section level3">
<h3 id="configuring-the-trial-simulations">Configuring the trial simulations<a class="anchor" aria-label="anchor" href="#configuring-the-trial-simulations"></a>
</h3>
<p>First and foremost, one needs to decide which of the possible six
trials need to be simulated and activate the corresponding trials. For
the example in this vignette, an monotherapy trial for compound 1 and a
combination therapy trial shall be included. We will assume that we have
chosen to utilize the <code>mono1.a</code> and <code>combi.a</code>
trials to represent these trials (although it would be equivalent to use
the <code>mono1.b</code> and <code>combi.b</code> trials or even a
combination of <code>mono1.b</code> and <code>combi.a</code>). To
activate the trials, we can supply the arguments</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">active.mono1.a</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="va">active.combi.a</span> <span class="op">=</span> <span class="cn">TRUE</span></span></code></pre></div>
<p>Now, we specify the corresponding available dose levels. For this, we
will use the same doses as specified previously:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doses.mono1.a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">2.4</span>, <span class="fl">3.6</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">doses.combi.a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">doses.mono1.a</span>, times<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">12</span><span class="op">)</span>,      each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">doses.mono1.a</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that <code>doses.mono1.a</code> is a vector, while
<code>doses.combi.a</code> needs to be a matrix with two rows, so that
each column specifies a dose combination to be considered in the
combination therapy trial. The code above generated every possible
combination of the doses from the monotherapy trial for compound 1 with
the doses 8 and 12 for compound 2.</p>
<p>As for the function <code>scenario_jointBLRM</code>, one again needs
to specify reference doses and a prior distribution for the BLRM. For
this, the same argument names and formats as for
<code>scenario_jointBLRM</code> are used, i.e. the arguments
<code>dose.ref1</code>, <code>dose.ref2</code>, <code>prior.mu</code>,
and <code>prior.tau</code> can be used in the form that was specified in
the previous section. The same holds for the historical data, for which
we will assume that the same observations as before are used, namely</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">historical.data</span></span>
<span><span class="co">#&gt; $dose1</span></span>
<span><span class="co">#&gt; [1] 0 0 0 0 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dose2</span></span>
<span><span class="co">#&gt; [1]  2  4  8 12 16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n.pat</span></span>
<span><span class="co">#&gt; [1]  3  3  3  9 12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n.dlt</span></span>
<span><span class="co">#&gt; [1] 0 0 0 1 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $trial</span></span>
<span><span class="co">#&gt; [1] "H1" "H1" "H1" "H1" "H1"</span></span></code></pre></div>
<p>Additionally, we need to provide starting dose levels for each
activated trials. Note that these must be elements of the set of
available dose levels, otherwise the function will report an error. We
will assume that the monotherapy trial will start with the lowest
available dose, 0.1, which is specified via</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">start.dose.mono1.a</span> <span class="op">=</span> <span class="fl">0.1</span></span></code></pre></div>
<p>We will later assume additionally that the monotherapy trial enrolls
at least 3 or 4 cohorts before the first combination therapy cohort is
processed, and due to this, we assume the combination trial to use a
slightly larger starting dose. For instance, suppose that the
combination therapy shall begin with the dose combination of 0.2 of
compound 1 and 8 of compound 2. This is expressed by using</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">start.dose.combi.a1</span> <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="va">start.dose.combi.a2</span> <span class="op">=</span> <span class="fl">8</span></span></code></pre></div>
<p>Note that two arguments need to be specified for this, with suffix
<code>.combi.a1</code> for the first compound and <code>.combi.a2</code>
for the second compound. Both of these arguments belong to the
<code>combi.a</code> trial, while the endings <code>.a1</code> and
<code>.a2</code> are used to differentiate between the setting for the
first and second compound of the <code>combi.a</code> trial. They are
also used for other arguments that may need different settings for the
two combination therapy partners in the same combination therapy
trial.</p>
<div class="section level4">
<h4 id="optional-general-specification">Optional general specification<a class="anchor" aria-label="anchor" href="#optional-general-specification"></a>
</h4>
<p>As a next step, the general course of the trial can be defined,
consisting of the number of patients per cohort, the maximum number of
patients in the trial, and the order in which cohorts are enrolled. All
of these arguments are optional, and relatively sensible defaults will
be used when they are not specified.</p>
<p>First, to set the number of patients per cohort, one can use e.g.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort.size</span> <span class="op">=</span> <span class="fl">3</span></span></code></pre></div>
<p>Note that <code>cohort.size</code> is the global variant of this
argument, i.e. it affects all simulated trials. If it is not provided
explicitly, the function will use the default value of 3. If a specific
trial shall deviate from this value, one can use the trial-specific
parameter with the corresponding trial suffix, e.g.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort.size.mono1.b</span> <span class="op">=</span> <span class="fl">4</span></span></code></pre></div>
<p>Note that this would only affect the <code>mono1.b</code> trial,
which we do not plan to simulate in the current example. For the
<code>mono1.a</code> and <code>combi.a</code> trial, which we do want to
simulate, the global cohort size of 3 is still in effect. The same would
apply if <code>cohort.size</code> is not given to the function, as the
default value would have been used in this case.</p>
<p>One can also provide a vector of multiple cohort sizes, in which case
the function will randomly select one of the given cohort sizes for each
cohort. The cohort sizes will then be drawn uniformly at random from the
possible numbers specified in ‘cohort.size’ if no further options are
given. If it is desired to draw each cohort size with a specific
probability, one can use the optional argument <code>cohort.prob</code>
to provide the probability for each cohort size, e.g. by setting</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort.size.mono1.b</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,    <span class="fl">3</span>,    <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">cohort.prob.mono1.b</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.85</span>, <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p>In this example, the <code>mono1.b</code> trial would select the size
of each cohort randomly according to the corresponding probabilities,
i.e. a cohort size of 2 is drawn with a probability of 0.05, a size of 3
with probability 0.85, and a cohort size of 4 will be chosen with a
probability of 0.1. As before, there is a global and trial-specific
version of the argument <code>cohort.prob</code>.</p>
<p>As a next step, we want to set the maximum number of patients for
each trial. We will assume the maximum number of patients to be 36 for
the combination therapy trial and 45 for the monotherapy trial. This can
be set via the trial-specific arguments</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max.n.mono1.a</span> <span class="op">=</span> <span class="fl">45</span></span>
<span><span class="va">max.n.combi.a</span> <span class="op">=</span> <span class="fl">36</span></span></code></pre></div>
<p>Note that there is also a global argument <code>max.n</code>, which
will not be used in this example.</p>
<p>Now, the order in which cohorts are enrolled is specified. For this,
the function uses the argument <code>cohort.queue</code>, which
provides, as the name says, a queue of cohorts that is processed during
the simulation. This can be done by supplying a simple pattern which is
automatically repeated (note however that the function will drop a
warning in this case) or by supplying a complex pattern that already
contains every cohort that may potentially be arriving throughout the
trial. For instance, to simply simulate cohorts for <code>mono1.a</code>
and <code>combi.a</code> alternately, one can use</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort.queue</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mono1.a"</span>, <span class="st">"combi.a"</span><span class="op">)</span></span></code></pre></div>
<p>This order would then be repeated until both trials concluded due to
being stopped early, having found an MTD, or reaching the maximum
patient number.</p>
<p>The cohort queue is mostly used to enforce a specific order of the
cohorts in a trial. For this, consider again the example from the
previous section, where a monotherapy and combination trial shall be
simulated in parallel. Assume for instance that one wants to start the
combination therapy trial after the first four monotherapy cohorts were
processed, and, afterwards, the trials shall enroll cohorts alternately.
This is expressed by setting the queue to</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort.queue</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mono1.a"</span>, <span class="st">"mono1.a"</span>, <span class="st">"mono1.a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mono1.a"</span>, <span class="st">"combi.a"</span><span class="op">)</span>,</span>
<span>                                                      times<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cohort.queue</span>, <span class="fl">9</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "mono1.a" "mono1.a" "mono1.a" "mono1.a" "combi.a" "mono1.a" "combi.a" "mono1.a" "combi.a"</span></span></code></pre></div>
<p>Note that <code>c("mono1.a", "combi.a")</code> is repeated 12 times,
which translates to 12 <code>"combi.a"</code> and 15
<code>"mono1.a"</code> cohorts in the queue. As the cohort size was
previously set to 3 patients, this results in a total of 36 patients for
<code>combi.a</code> in the queue and 45 patients for
<code>mono1.a</code>, i.e. precisely the maximum sample size that was
specified. This ensures that the function will not need to repeat the
queue automatically. Note that it would not be a problem to provide a
cohort queue containing more patients than required, as the function
will simply ignore cohorts for each simulated trial once it has
concluded. Therefore, it is also possible to use e.g.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort.queue</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mono1.a"</span>, <span class="st">"mono1.a"</span>, <span class="st">"mono1.a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mono1.a"</span>, <span class="st">"combi.a"</span><span class="op">)</span>,</span>
<span>                                                      times<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Here, we supplied much more cohorts than needed (100 for combination
therapy), which is still equivalent to the previous queue. Only
supplying lower numbers of cohorts will cause the function to operate
differently, as it will repeat the cohort queue until all trials
concluded.</p>
<p>Note that the trials in the cohort queue can also be indicated with
numbers (which usually leads to shorter code than the full trial names),
as stated in the following table.</p>
<table class="table">
<thead><tr class="header">
<th>Trial</th>
<th align="center">Suffix of function arguments</th>
<th align="center">Number</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1st monotherapy trial for compound 1</td>
<td align="center"><code>mono1.a</code></td>
<td align="center">1</td>
</tr>
<tr class="even">
<td>1st monotherapy trial for compound 2</td>
<td align="center"><code>mono2.a</code></td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td>1st combination therapy trial</td>
<td align="center"><code>combi.a</code></td>
<td align="center">3</td>
</tr>
<tr class="even">
<td>2nd monotherapy trial for compound 1</td>
<td align="center"><code>mono1.b</code></td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td>2nd monotherapy trial for compound 2</td>
<td align="center"><code>mono2.b</code></td>
<td align="center">5</td>
</tr>
<tr class="even">
<td>2nd combination therapy trial</td>
<td align="center"><code>combi.b</code></td>
<td align="center">6</td>
</tr>
</tbody>
</table>
<p>Hence, the previous cohort queue could be equivalently written as</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort.queue</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, times<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="escalation-decisions-in-simulted-trials">Escalation decisions in simulted trials<a class="anchor" aria-label="anchor" href="#escalation-decisions-in-simulted-trials"></a>
</h4>
<p>As a next step, we specify rules for dose escalation decisions. As
mentioned before, the function will by default apply EWOC-based
escalation, which means that only doses can be chosen for which the
posterior probability of overdosing is below 0.25. This boundary could
also be altered, by using the argument</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ewoc.threshold</span> <span class="op">=</span> <span class="fl">0.25</span></span></code></pre></div>
<p>As EWOC only states an upper boundary, the function will afterwards
maximize the probability of having a DLT rate within the target interval
among the doses that satisfy EWOC. If this still leads to multiple
possible doses, the function will subsequently maximize the dose of the
first compound among the doses with the same probability of target
dosing. To maximize the second compound instead, one can set the
argument <code>esc.comp.max</code>, which may have the values
<code>1</code> or <code>2</code> and indicates which component the
function will maximize in case of draws. Note that one can also deviate
from maximizing the target probability and maximize directly the dose
among the levels that satisfy EWOC, but this is not covered in this
vignette. Refer to the documentation of the argument
<code>esc.rule</code> for information on this.</p>
<p><span class="citation">Neuenschwander et al. (2014)</span> recommend
to impose a maximum increment of the dose additionally to EWOC, in order
to avoid overly large dosing steps during dose escalations. This can be
realized by using the <code>esc.step</code> family of arguments, which
is available as a global variant and six trial-specific parameters. The
escalation step is interpreted as the maximum factor of dose escalation.
For instance, when an escalation step is set to the value 2, the dose
can at most be doubled in each escalation decision. If no escalation
step is given, the function will set it to the maximum factor between
subsequent dose levels as an additional constrain on the escalation.</p>
<p>However, there might be situations in which one may not want a fixed
maximum factor between escalations, e.g. if a factor cannot express the
increments between planned dose levels. Consider for instance a trial
with planned doses of 10, 20, 30, and 40 mg. In order to allow
escalating from 10 to 20, the escalation step would need to be set to 2,
but this would also allow escalating from 20 to 40 without enrolling
patients at 30. To prevent this, one can set</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">esc.constrain</span> <span class="op">=</span> <span class="cn">TRUE</span></span></code></pre></div>
<p>This argument constrains escalations to the given set of dose levels,
i.e. only the next larger prespecified dose can be used. If activated,
<code>esc.constrain</code> causes the function to ignore any given
escalation step and always restrict escalation decisions to the next
larger dose (but does not pose a boundary when deescalating the dose).
As before, <code>esc.constrain</code> is the global variant, while
additional arguments like <code>esc.constrain.mono1.b</code> only affect
the corresponding trial.</p>
</div>
<div class="section level4">
<h4 id="mtd-selection">MTD selection<a class="anchor" aria-label="anchor" href="#mtd-selection"></a>
</h4>
<p>It now remains to specify the rules for MTD selection in the
trial.</p>
<p>There are two different arguments that control how the function
selects the MTD of a simulated trial, namely <code>mtd.decision</code>
and <code>mtd.enforce</code>. Both are available as global arguments
without suffix and as trial-specific argument with the corresponding
suffix. The argument <code>mtd.decision</code> is a named list with five
entries of the form</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtd.decision</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  min.dlt     <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pat.at.mtd  <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  min.pat     <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  target.prob <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  rule        <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The list stated above is also the default argument. The first four
list entries correspond to the demanded boundaries of four different
conditions that are used to determine an MTD. The last entry,
<code>mtd.decision$rule</code> does not pose a condition itself, but
dictates which of the other conditions are mandatory instead.</p>
<p>During the simulation, the MTD can only be determined as the dose
that was used for the last cohort, which is always the current candidate
for the MTD. For MTD selection, the function will then first demand that
the current dose level is also recommended for the next cohort again
(so-called stabilization criterion). If this is the case, it will check
whether the current dose also satisfies the conditions determined by
<code>mtd.decision</code>, and, if these are satisfied, declare the
current dose to be the MTD of this trial. The precise conditions and the
corresponding entries in <code>mtd.decision</code> are listed in the
following table.</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="26%">
<col width="53%">
</colgroup>
<thead><tr class="header">
<th align="left">No.</th>
<th align="left">List entry</th>
<th align="left">Condition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left"><code>min.dlt</code></td>
<td align="left">At least <code>min.dlt</code> patients with DLTs were
observed in the trial.</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left"><code>pat.at.mtd</code></td>
<td align="left">At least <code>pat.at.mtd</code> patients were treated
with the current dose.</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left"><code>min.pat</code></td>
<td align="left">At least <code>min.pat</code> patients were treated in
the current trial.</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left"><code>target.prob</code></td>
<td align="left">The probability that the current dose has DLT rate in
the target interval is at least <code>target.prob</code>.</td>
</tr>
</tbody>
</table>
<p>In terms of the effect of the entry <code>rule</code>, the following
to possibilities are supported</p>
<ul>
<li><p><strong>If <code>rule</code> is <code>1</code></strong>:
Conditions 1 and 2 are necessary, and at least one of conditions 3 and 4
must be satisfied as well.</p></li>
<li><p><strong>If <code>rule</code> is <code>2</code></strong>:
Conditions 1 and 3 are necessary, and at least one of conditions 2 and 4
must be satisfied as well.</p></li>
</ul>
<p>Other decision rule specifications may be supported in the
future.</p>
<p>The second argument that affects MTD selection,
<code>mtd.enforce</code>, is a logical value that controls how the
function behaves when a trial reaches the specified maximum sample size.
By default, <code>mtd.enforce</code> is <code>FALSE</code>, which causes
trials that reach the maximum sample size to be considered as not having
found an MTD, which will also be noted in the output. If the parameter
is instead <code>TRUE</code>, the current dose will be considered the
MTD when the maximum sample size is reached before the conditions for
MTD selections are satisfied. This can e.g. be used if one wants to
approximate the average dosing recommendations after a specific number
of cohorts based on simulations. For instance, when
<code>max.n = 15</code>, <code>mtd.enforce = TRUE</code>, one can set
<code>mtd.decision</code> to values that cannot be reached within 15
patients (e.g., <code>mtd.decision$rule = 2</code> and
<code>mtd.decision$min.pat = 16</code>), so that the function will
simply report the dosing recommendation after 15 patients as the MTD and
not apply the MTD decision rule. This option can also be set for
individual trials (via the parameters with the corresponding
suffix).</p>
</div>
<div class="section level4">
<h4 id="dose-toxicity-scenarios-and-trial-simulations">Dose-toxicity scenarios and trial simulations<a class="anchor" aria-label="anchor" href="#dose-toxicity-scenarios-and-trial-simulations"></a>
</h4>
<p>It remains to specify a dose-toxicity scenario before the simulation
can be started. That is, a DLT rate for each dose level is assumed,
which is then used by the function to simulate the number of patients
experiencing DLT in each cohort.</p>
<p>The arguments for specifying the DLT rate in one of the simulated
trials are named according to the pattern <code>tox.[...]</code>, where
<code>[...]</code> can be any of the trial-specific suffixes. Note that
there is no global variant of this argument. For the situation discussed
in the previous chapters, the required arguments are therefore
<code>tox.mono1.a</code> and <code>tox.combi.a</code>.</p>
<p>First, recall the specification of the dose levels for the
monotherapy trial:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doses.mono1.a</span></span>
<span><span class="co">#&gt; [1] 0.1 0.2 0.4 0.8 1.6 2.4 3.6 5.0 6.0</span></span></code></pre></div>
<p>The DLT rates (or toxicities) must therefore be specified for 9 dose
levels. This is done by supplying a vector of this length, so that the
entry <code>tox.mono1.a[i]</code> specifies the DLT rate of the dose
given in <code>doses.mono1.a[i]</code>. In our case, this could
e.g. be</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Compound 1:     0.1   0.2   0.4   0.8   1.6   2.4   3.6   5     6</span></span>
<span><span class="va">tox.mono1.a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.05</span>, <span class="fl">0.09</span>, <span class="fl">0.12</span>, <span class="fl">0.19</span>, <span class="fl">0.29</span>, <span class="fl">0.43</span><span class="op">)</span></span></code></pre></div>
<p>Similarly, for the combination therapy trial, the dose levels were
given as</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doses.combi.a</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16] [,17] [,18]</span></span>
<span><span class="co">#&gt; [1,]  0.1  0.2  0.4  0.8  1.6  2.4  3.6    5    6   0.1   0.2   0.4   0.8   1.6   2.4   3.6     5     6</span></span>
<span><span class="co">#&gt; [2,]  8.0  8.0  8.0  8.0  8.0  8.0  8.0    8    8  12.0  12.0  12.0  12.0  12.0  12.0  12.0    12    12</span></span></code></pre></div>
<p>Here, each column specifies a dose, so that the argument
<code>tox.combi.a</code> needs one entry for each column, i.e. 18
entries in our example. Similarly to before, entry <code>i</code> of the
argument provides the DLT rate of the dose given in column
<code>i</code> of <code>doses.combi.a</code>. Hence, a dose-toxicity
scenario for this case could be</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Compound 1:     0.1   0.2   0.4   0.8   1.6   2.4   3.6   5     6        0.1   0.2   0.4   0.8   1.6   2.4   3.6   5     6</span></span>
<span><span class="co">#compound 2:     8     8     8     8     8     8     8     8     8        12    12    12    12    12    12    12    12    12</span></span>
<span><span class="va">tox.combi.a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.08</span>, <span class="fl">0.14</span>, <span class="fl">0.21</span>, <span class="fl">0.32</span>, <span class="fl">0.39</span>, <span class="fl">0.47</span>,    <span class="fl">0.04</span>, <span class="fl">0.06</span>, <span class="fl">0.09</span>, <span class="fl">0.12</span>, <span class="fl">0.17</span>, <span class="fl">0.29</span>, <span class="fl">0.45</span>, <span class="fl">0.52</span>, <span class="fl">0.61</span><span class="op">)</span></span></code></pre></div>
<p>Note that one will usually consider multiple different dose toxicity
scenarios to assess the performance of the prior in different settings
and situations. In the following, we will only consider the scenario
specified above for simplicity.</p>
<p>This completes the setup and specification of the trials that are to
be simulated. As a last step, it remains to specify the number of
simulated studies via the parameter <code>n.studies</code>. As an
example, 1 study will be used in the following. Note however that this
is of course by far not sufficient for a proper evaluation of the prior,
where one should simulate something around the order of e.g. 1000 to
10000 studies. However, be aware that depending on the specifications,
each study will require up to multiple minutes of run time for the
repeated calls to Stan, so that 1000 or more trials may take multiple
hours or even nearly a day to simulate. It is therefore recommended to
run the simulation in parallel.</p>
<p>If a cluster is available, a parallel backend consisting of multiple
nodes with multiple cores can be registered, so that the function can
leverage the capabilities of a cluster with a nested foreach loop. This
is however purely optional. Further, when running simulations in
parallel with a moderate number of cores, it is recommended to consider
the argument <code>working.path</code> in the documentation, as this
allows to save a reload MCMC results across nodes and cores.</p>
<p>At last, one can also optionally specify the arguments
<code>path</code> and <code>file.name</code>, which will cause the
function to automatically write the summarized simulation results to a
<code>.xlsx</code> file of the specified name under the specified path.
Otherwise, the simulation results are only returned to R.</p>
<p>Putting all of the previous explanations together, the call to
<code>sim_jointBLRM</code> would therefore be:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_jointBLRM.html">sim_jointBLRM</a></span><span class="op">(</span></span>
<span>  active.mono1.a <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  active.combi.a <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span></span>
<span>  doses.mono1.a <span class="op">=</span> <span class="va">doses.mono1.a</span>,</span>
<span>  doses.combi.a <span class="op">=</span> <span class="va">doses.combi.a</span>,</span>
<span>  dose.ref1 <span class="op">=</span> <span class="va">dose.ref1</span>,</span>
<span>  dose.ref2 <span class="op">=</span> <span class="va">dose.ref2</span>,</span>
<span>  start.dose.mono1.a <span class="op">=</span> <span class="va">start.dose.mono1.a</span>,</span>
<span>  start.dose.combi.a1 <span class="op">=</span> <span class="va">start.dose.combi.a1</span>,</span>
<span>  start.dose.combi.a2 <span class="op">=</span> <span class="va">start.dose.combi.a2</span>,</span>
<span></span>
<span>  tox.mono1.a <span class="op">=</span> <span class="va">tox.mono1.a</span>,</span>
<span>  tox.combi.a <span class="op">=</span> <span class="va">tox.combi.a</span>,</span>
<span></span>
<span>  historical.data <span class="op">=</span> <span class="va">historical.data</span>,</span>
<span>  prior.mu <span class="op">=</span> <span class="va">prior.mu</span>,</span>
<span>  prior.tau <span class="op">=</span> <span class="va">prior.tau</span>,</span>
<span></span>
<span>  max.n.mono1.a <span class="op">=</span> <span class="va">max.n.mono1.a</span>,</span>
<span>  max.n.combi.a <span class="op">=</span> <span class="va">max.n.combi.a</span>,</span>
<span>  cohort.size <span class="op">=</span> <span class="va">cohort.size</span>,</span>
<span>  cohort.queue <span class="op">=</span> <span class="va">cohort.queue</span>,</span>
<span>  ewoc.threshold <span class="op">=</span> <span class="va">ewoc.threshold</span>,</span>
<span>  esc.constrain <span class="op">=</span> <span class="va">esc.constrain</span>,</span>
<span>  mtd.decision <span class="op">=</span> <span class="va">mtd.decision</span>,</span>
<span></span>
<span>  n.studies <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sim_result</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`results combi.a`</span></span>
<span><span class="co">#&gt;                              underdose target dose overdose max n reached before MTD all doses too toxic</span></span>
<span><span class="co">#&gt; Number of trials                     0           1        0                        0                   0</span></span>
<span><span class="co">#&gt; Percentage                           0         100        0                        0                   0</span></span>
<span><span class="co">#&gt; Percentage not all too toxic         0         100        0                        0                  NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`summary combi.a`</span></span>
<span><span class="co">#&gt;                      Median       Mean       Min.       Max.       2.5%      97.5%</span></span>
<span><span class="co">#&gt; #Pat underdose    9.0000000  9.0000000  9.0000000  9.0000000  9.0000000  9.0000000</span></span>
<span><span class="co">#&gt; #Pat target dose  6.0000000  6.0000000  6.0000000  6.0000000  6.0000000  6.0000000</span></span>
<span><span class="co">#&gt; #Pat overdose     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</span></span>
<span><span class="co">#&gt; #Pat (all)       15.0000000 15.0000000 15.0000000 15.0000000 15.0000000 15.0000000</span></span>
<span><span class="co">#&gt; #DLT underdose    1.0000000  1.0000000  1.0000000  1.0000000  1.0000000  1.0000000</span></span>
<span><span class="co">#&gt; #DLT target dose  1.0000000  1.0000000  1.0000000  1.0000000  1.0000000  1.0000000</span></span>
<span><span class="co">#&gt; #DLT overdose     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</span></span>
<span><span class="co">#&gt; #DLT (all)        2.0000000  2.0000000  2.0000000  2.0000000  2.0000000  2.0000000</span></span>
<span><span class="co">#&gt; % overdose        0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</span></span>
<span><span class="co">#&gt; % DLT             0.1333333  0.1333333  0.1333333  0.1333333  0.1333333  0.1333333</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`MTDs combi.a`</span></span>
<span><span class="co">#&gt;                  0.1+8       0.2+8       0.4+8       0.8+8       1.6+8       2.4+8         3.6+8         5+8       </span></span>
<span><span class="co">#&gt; Dose             "0.1+8"     "0.2+8"     "0.4+8"     "0.8+8"     "1.6+8"     "2.4+8"       "3.6+8"       "5+8"     </span></span>
<span><span class="co">#&gt; True P(DLT)      "0.02"      "0.03"      "0.04"      "0.08"      "0.14"      "0.21"        "0.32"        "0.39"    </span></span>
<span><span class="co">#&gt; True category    "underdose" "underdose" "underdose" "underdose" "underdose" "target dose" "target dose" "overdose"</span></span>
<span><span class="co">#&gt; MTD declared (n) "0"         "0"         "0"         "0"         "0"         "0"           "0"           "0"       </span></span>
<span><span class="co">#&gt;                  6+8        0.1+12      0.2+12      0.4+12      0.8+12      1.6+12        2.4+12        3.6+12    </span></span>
<span><span class="co">#&gt; Dose             "6+8"      "0.1+12"    "0.2+12"    "0.4+12"    "0.8+12"    "1.6+12"      "2.4+12"      "3.6+12"  </span></span>
<span><span class="co">#&gt; True P(DLT)      "0.47"     "0.04"      "0.06"      "0.09"      "0.12"      "0.17"        "0.29"        "0.45"    </span></span>
<span><span class="co">#&gt; True category    "overdose" "underdose" "underdose" "underdose" "underdose" "target dose" "target dose" "overdose"</span></span>
<span><span class="co">#&gt; MTD declared (n) "0"        "0"         "0"         "0"         "0"         "0"           "1"           "0"       </span></span>
<span><span class="co">#&gt;                  5+12       6+12      </span></span>
<span><span class="co">#&gt; Dose             "5+12"     "6+12"    </span></span>
<span><span class="co">#&gt; True P(DLT)      "0.52"     "0.61"    </span></span>
<span><span class="co">#&gt; True category    "overdose" "overdose"</span></span>
<span><span class="co">#&gt; MTD declared (n) "0"        "0"       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`#pat. combi.a`</span></span>
<span><span class="co">#&gt;             0.1+8   0.2+8   0.4+8   0.8+8   1.6+8   2.4+8   3.6+8   5+8   6+8   0.1+12   0.2+12   0.4+12   0.8+12  </span></span>
<span><span class="co">#&gt; Dose        "0.1+8" "0.2+8" "0.4+8" "0.8+8" "1.6+8" "2.4+8" "3.6+8" "5+8" "6+8" "0.1+12" "0.2+12" "0.4+12" "0.8+12"</span></span>
<span><span class="co">#&gt; mean #pat   "0"     "3"     "0"     "0"     "0"     "0"     "0"     "0"   "0"   "0"      "0"      "3"      "3"     </span></span>
<span><span class="co">#&gt; median #pat "0"     "3"     "0"     "0"     "0"     "0"     "0"     "0"   "0"   "0"      "0"      "3"      "3"     </span></span>
<span><span class="co">#&gt; min #pat    "0"     "3"     "0"     "0"     "0"     "0"     "0"     "0"   "0"   "0"      "0"      "3"      "3"     </span></span>
<span><span class="co">#&gt; max #pat    "0"     "3"     "0"     "0"     "0"     "0"     "0"     "0"   "0"   "0"      "0"      "3"      "3"     </span></span>
<span><span class="co">#&gt;             1.6+12   2.4+12   3.6+12   5+12   6+12  </span></span>
<span><span class="co">#&gt; Dose        "1.6+12" "2.4+12" "3.6+12" "5+12" "6+12"</span></span>
<span><span class="co">#&gt; mean #pat   "3"      "3"      "0"      "0"    "0"   </span></span>
<span><span class="co">#&gt; median #pat "3"      "3"      "0"      "0"    "0"   </span></span>
<span><span class="co">#&gt; min #pat    "3"      "3"      "0"      "0"    "0"   </span></span>
<span><span class="co">#&gt; max #pat    "3"      "3"      "0"      "0"    "0"   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`#DLT combi.a`</span></span>
<span><span class="co">#&gt;             0.1+8   0.2+8   0.4+8   0.8+8   1.6+8   2.4+8   3.6+8   5+8   6+8   0.1+12   0.2+12   0.4+12   0.8+12  </span></span>
<span><span class="co">#&gt; Dose        "0.1+8" "0.2+8" "0.4+8" "0.8+8" "1.6+8" "2.4+8" "3.6+8" "5+8" "6+8" "0.1+12" "0.2+12" "0.4+12" "0.8+12"</span></span>
<span><span class="co">#&gt; mean #DLT   "0"     "0"     "0"     "0"     "0"     "0"     "0"     "0"   "0"   "0"      "0"      "0"      "1"     </span></span>
<span><span class="co">#&gt; median #DLT "0"     "0"     "0"     "0"     "0"     "0"     "0"     "0"   "0"   "0"      "0"      "0"      "1"     </span></span>
<span><span class="co">#&gt; min #DLT    "0"     "0"     "0"     "0"     "0"     "0"     "0"     "0"   "0"   "0"      "0"      "0"      "1"     </span></span>
<span><span class="co">#&gt; max #DLT    "0"     "0"     "0"     "0"     "0"     "0"     "0"     "0"   "0"   "0"      "0"      "0"      "1"     </span></span>
<span><span class="co">#&gt;             1.6+12   2.4+12   3.6+12   5+12   6+12  </span></span>
<span><span class="co">#&gt; Dose        "1.6+12" "2.4+12" "3.6+12" "5+12" "6+12"</span></span>
<span><span class="co">#&gt; mean #DLT   "0"      "1"      "0"      "0"    "0"   </span></span>
<span><span class="co">#&gt; median #DLT "0"      "1"      "0"      "0"    "0"   </span></span>
<span><span class="co">#&gt; min #DLT    "0"      "1"      "0"      "0"    "0"   </span></span>
<span><span class="co">#&gt; max #DLT    "0"      "1"      "0"      "0"    "0"   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`results mono1.a`</span></span>
<span><span class="co">#&gt;                              underdose target dose overdose max n reached before MTD all doses too toxic</span></span>
<span><span class="co">#&gt; Number of trials                     0           1        0                        0                   0</span></span>
<span><span class="co">#&gt; Percentage                           0         100        0                        0                   0</span></span>
<span><span class="co">#&gt; Percentage not all too toxic         0         100        0                        0                  NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`summary mono1.a`</span></span>
<span><span class="co">#&gt;                      Median       Mean       Min.       Max.       2.5%      97.5%</span></span>
<span><span class="co">#&gt; #Pat underdose   21.0000000 21.0000000 21.0000000 21.0000000 21.0000000 21.0000000</span></span>
<span><span class="co">#&gt; #Pat target dose  6.0000000  6.0000000  6.0000000  6.0000000  6.0000000  6.0000000</span></span>
<span><span class="co">#&gt; #Pat overdose     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</span></span>
<span><span class="co">#&gt; #Pat (all)       27.0000000 27.0000000 27.0000000 27.0000000 27.0000000 27.0000000</span></span>
<span><span class="co">#&gt; #DLT underdose    1.0000000  1.0000000  1.0000000  1.0000000  1.0000000  1.0000000</span></span>
<span><span class="co">#&gt; #DLT target dose  2.0000000  2.0000000  2.0000000  2.0000000  2.0000000  2.0000000</span></span>
<span><span class="co">#&gt; #DLT overdose     0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</span></span>
<span><span class="co">#&gt; #DLT (all)        3.0000000  3.0000000  3.0000000  3.0000000  3.0000000  3.0000000</span></span>
<span><span class="co">#&gt; % overdose        0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000</span></span>
<span><span class="co">#&gt; % DLT             0.1111111  0.1111111  0.1111111  0.1111111  0.1111111  0.1111111</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`MTDs mono1.a`</span></span>
<span><span class="co">#&gt;                  0.1         0.2         0.4         0.8         1.6         2.4         3.6           5            </span></span>
<span><span class="co">#&gt; Dose             "0.1"       "0.2"       "0.4"       "0.8"       "1.6"       "2.4"       "3.6"         "5"          </span></span>
<span><span class="co">#&gt; True P(DLT)      "0.01"      "0.02"      "0.03"      "0.05"      "0.09"      "0.12"      "0.19"        "0.29"       </span></span>
<span><span class="co">#&gt; True category    "underdose" "underdose" "underdose" "underdose" "underdose" "underdose" "target dose" "target dose"</span></span>
<span><span class="co">#&gt; MTD declared (n) "0"         "0"         "0"         "0"         "0"         "0"         "1"           "0"          </span></span>
<span><span class="co">#&gt;                  6         </span></span>
<span><span class="co">#&gt; Dose             "6"       </span></span>
<span><span class="co">#&gt; True P(DLT)      "0.43"    </span></span>
<span><span class="co">#&gt; True category    "overdose"</span></span>
<span><span class="co">#&gt; MTD declared (n) "0"       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`#pat. mono1.a`</span></span>
<span><span class="co">#&gt;             0.1   0.2   0.4   0.8   1.6   2.4   3.6   5   6  </span></span>
<span><span class="co">#&gt; Dose        "0.1" "0.2" "0.4" "0.8" "1.6" "2.4" "3.6" "5" "6"</span></span>
<span><span class="co">#&gt; mean #pat   "3"   "3"   "3"   "6"   "3"   "3"   "6"   "0" "0"</span></span>
<span><span class="co">#&gt; median #pat "3"   "3"   "3"   "6"   "3"   "3"   "6"   "0" "0"</span></span>
<span><span class="co">#&gt; min #pat    "3"   "3"   "3"   "6"   "3"   "3"   "6"   "0" "0"</span></span>
<span><span class="co">#&gt; max #pat    "3"   "3"   "3"   "6"   "3"   "3"   "6"   "0" "0"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`#DLT mono1.a`</span></span>
<span><span class="co">#&gt;             0.1   0.2   0.4   0.8   1.6   2.4   3.6   5   6  </span></span>
<span><span class="co">#&gt; Dose        "0.1" "0.2" "0.4" "0.8" "1.6" "2.4" "3.6" "5" "6"</span></span>
<span><span class="co">#&gt; mean #DLT   "0"   "0"   "0"   "1"   "0"   "0"   "2"   "0" "0"</span></span>
<span><span class="co">#&gt; median #DLT "0"   "0"   "0"   "1"   "0"   "0"   "2"   "0" "0"</span></span>
<span><span class="co">#&gt; min #DLT    "0"   "0"   "0"   "1"   "0"   "0"   "2"   "0" "0"</span></span>
<span><span class="co">#&gt; max #DLT    "0"   "0"   "0"   "1"   "0"   "0"   "2"   "0" "0"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`historical data`</span></span>
<span><span class="co">#&gt;        Obs1 Obs2 Obs3 Obs4 Obs5</span></span>
<span><span class="co">#&gt; Dose 1    0    0    0    0    0</span></span>
<span><span class="co">#&gt; Dose 2    2    4    8   12   16</span></span>
<span><span class="co">#&gt; N Pat.    3    3    3    9   12</span></span>
<span><span class="co">#&gt; N DLT     0    0    0    1    2</span></span>
<span><span class="co">#&gt; Trial     7    7    7    7    7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prior</span></span>
<span><span class="co">#&gt;               mean        SD</span></span>
<span><span class="co">#&gt; mu_a1   -0.7081851 3.0000000</span></span>
<span><span class="co">#&gt; mu_b1    0.0000000 1.0000000</span></span>
<span><span class="co">#&gt; mu_a2   -0.7081851 3.0000000</span></span>
<span><span class="co">#&gt; mu_b2    0.0000000 1.0000000</span></span>
<span><span class="co">#&gt; mu_eta   0.0000000 1.1210000</span></span>
<span><span class="co">#&gt; tau_a1  -1.3862944 0.3536465</span></span>
<span><span class="co">#&gt; tau_b1  -2.0794415 0.3536465</span></span>
<span><span class="co">#&gt; tau_a2  -1.3862944 0.3536465</span></span>
<span><span class="co">#&gt; tau_b2  -2.0794415 0.3536465</span></span>
<span><span class="co">#&gt; tau_eta -2.0794415 0.3536465</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $specifications</span></span>
<span><span class="co">#&gt;                                  Value       -     </span></span>
<span><span class="co">#&gt; seed                             "558535265" "-"   </span></span>
<span><span class="co">#&gt; dosing.intervals                 "0.16"      "0.33"</span></span>
<span><span class="co">#&gt; esc.rule                         "ewoc"      "-"   </span></span>
<span><span class="co">#&gt; esc.comp.max                     "1"         "-"   </span></span>
<span><span class="co">#&gt; dose.ref1                        "6"         "-"   </span></span>
<span><span class="co">#&gt; dose.ref2                        "12"        "-"   </span></span>
<span><span class="co">#&gt; saturating                       "FALSE"     "-"   </span></span>
<span><span class="co">#&gt; ewoc.threshold                   "0.25"      "-"   </span></span>
<span><span class="co">#&gt; start.dose.mono1.a               "0.1"       "-"   </span></span>
<span><span class="co">#&gt; esc.step.mono1.a                 "2"         "-"   </span></span>
<span><span class="co">#&gt; esc.constrain.mono1.a            "TRUE"      "-"   </span></span>
<span><span class="co">#&gt; max.n.mono1.a                    "45"        "-"   </span></span>
<span><span class="co">#&gt; cohort.size.mono1.a              "3"         "-"   </span></span>
<span><span class="co">#&gt; cohort.prob.mono1.a              "1"         "-"   </span></span>
<span><span class="co">#&gt; mtd.decision.mono1.a$target.prob "0.5"       "-"   </span></span>
<span><span class="co">#&gt; mtd.decision.mono1.a$pat.at.mtd  "6"         "-"   </span></span>
<span><span class="co">#&gt; mtd.decision.mono1.a$min.pat     "12"        "-"   </span></span>
<span><span class="co">#&gt; mtd.decision.mono1.a$min.dlt     "1"         "-"   </span></span>
<span><span class="co">#&gt; mtd.decision.mono1.a$rule        "2"         "-"   </span></span>
<span><span class="co">#&gt; mtd.enforce.mono1.a              "FALSE"     "-"   </span></span>
<span><span class="co">#&gt; backfill.mono1.a                 "FALSE"     "-"   </span></span>
<span><span class="co">#&gt; backfill.size.mono1.a            "3"         "-"   </span></span>
<span><span class="co">#&gt; backfill.prob.mono1.a            "1"         "-"   </span></span>
<span><span class="co">#&gt; backfill.start.mono1.a           "0.1"       "-"   </span></span>
<span><span class="co">#&gt; start.dose.combi.a1              "0.2"       "-"   </span></span>
<span><span class="co">#&gt; start.dose.combi.a2              "8"         "-"   </span></span>
<span><span class="co">#&gt; esc.step.combi.a1                "2"         "-"   </span></span>
<span><span class="co">#&gt; esc.step.combi.a2                "1.5"       "-"   </span></span>
<span><span class="co">#&gt; esc.constrain.combi.a1           "TRUE"      "-"   </span></span>
<span><span class="co">#&gt; esc.constrain.combi.a2           "TRUE"      "-"   </span></span>
<span><span class="co">#&gt; max.n.combi.a                    "36"        "-"   </span></span>
<span><span class="co">#&gt; cohort.size.combi.a              "3"         "-"   </span></span>
<span><span class="co">#&gt; cohort.prob.combi.a              "1"         "-"   </span></span>
<span><span class="co">#&gt; mtd.decision.combi.a$target.prob "0.5"       "-"   </span></span>
<span><span class="co">#&gt; mtd.decision.combi.a$pat.at.mtd  "6"         "-"   </span></span>
<span><span class="co">#&gt; mtd.decision.combi.a$min.pat     "12"        "-"   </span></span>
<span><span class="co">#&gt; mtd.decision.combi.a$min.dlt     "1"         "-"   </span></span>
<span><span class="co">#&gt; mtd.decision.combi.a$rule        "2"         "-"   </span></span>
<span><span class="co">#&gt; mtd.enforce.combi.a              "FALSE"     "-"   </span></span>
<span><span class="co">#&gt; backfill.combi.a                 "FALSE"     "-"   </span></span>
<span><span class="co">#&gt; backfill.size.combi.a            "3"         "-"   </span></span>
<span><span class="co">#&gt; backfill.prob.combi.a            "1"         "-"   </span></span>
<span><span class="co">#&gt; backfill.start.combi.a1          "0.1"       "-"   </span></span>
<span><span class="co">#&gt; backfill.start.combi.a2          "8"         "-"   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Stan options`</span></span>
<span><span class="co">#&gt;                 Value</span></span>
<span><span class="co">#&gt; chains            4.0</span></span>
<span><span class="co">#&gt; iter          13500.0</span></span>
<span><span class="co">#&gt; warmup         1000.0</span></span>
<span><span class="co">#&gt; adapt_delta       0.8</span></span>
<span><span class="co">#&gt; max_treedepth    15.0</span></span></code></pre></div>
<p>This completes the setup of the simulation function for prior
evaluations. As mentioned before, it is recommended to evaluate multiple
different scenarios for at least multiple hundred studies when assessing
the performance of an actual design.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-babb98" class="csl-entry">
Babb, James, André Rogatko, and Shelemyahu Zacks. 1998. <span>“Cancer
Phase <span>I</span> Clinical Trials: <span>E</span>fficient Dose
Escalation with Overdose Control.”</span> <em>Statistics in
Medicine</em> 17 (10): 1103–20. <a href="https://doi.org/10.1002/(SICI)1097-0258(19980530)17:10&lt;1103::AID-SIM793&gt;3.0.CO;2-9" class="external-link">https://doi.org/10.1002/(SICI)1097-0258(19980530)17:10&lt;1103::AID-SIM793&gt;3.0.CO;2-9</a>.
</div>
<div id="ref-neuenschwander08" class="csl-entry">
Neuenschwander, Beat, Michael Branson, and Thomas Gsponer. 2008.
<span>“Critical Aspects of the <span>B</span>ayesian Approach to Phase
<span>I</span> Cancer Trials.”</span> <em>Statistics in Medicine</em> 27
(13): 2420–39. <a href="https://doi.org/10.1002/sim.3230" class="external-link">https://doi.org/10.1002/sim.3230</a>.
</div>
<div id="ref-neuenschwander14" class="csl-entry">
Neuenschwander, Beat, Alessandro Matano, Zhongwen Tang, Satrajit
Roychoudhury, Simon Wandel, and Stuart Bailey. 2014. <span>“A
<span>B</span>ayesian <span>I</span>ndustry <span>A</span>pproach to
<span>P</span>hase <span>I</span> <span>C</span>ombination
<span>T</span>rials in <span>O</span>ncology.”</span> In <em>Statistical
Methods in Drug Combination Studies</em>, 95–135. Chapman; Hall/CRC. <a href="https://doi.org/10.1201/b17965" class="external-link">https://doi.org/10.1201/b17965</a>.
</div>
<div id="ref-neuenschwander16" class="csl-entry">
Neuenschwander, Beat, Satrajit Roychoudhury, and Heinz Schmidli. 2016.
<span>“On the <span>U</span>se of <span>C</span>o-<span>D</span>ata in
<span>C</span>linical <span>T</span>rials.”</span> <em>Statistics in
Biopharmaceutical Research</em> 8 (3): 345–54. <a href="https://doi.org/10.1080/19466315.2016.1174149" class="external-link">https://doi.org/10.1080/19466315.2016.1174149</a>.
</div>
<div id="ref-neuenschwander20a" class="csl-entry">
Neuenschwander, Beat, Sebastian Weber, Heinz Schmidli, and Anthony
O’Hagan. 2020. <span>“Predictively Consistent Prior Effective Sample
Sizes.”</span> <em>Biometrics</em> 76 (2): 578–87. <a href="https://doi.org/10.1111/biom.13252" class="external-link">https://doi.org/10.1111/biom.13252</a>.
</div>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.1.2 (2021-11-01)</span></span>
<span><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64 (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Windows 10 x64 (build 19044)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252    LC_MONETARY=German_Germany.1252</span></span>
<span><span class="co">#&gt; [4] LC_NUMERIC=C                    LC_TIME=German_Germany.1252    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] future.batchtools_0.12.0 parallelly_1.35.0        doRNG_1.8.2              rngtools_1.5.2          </span></span>
<span><span class="co">#&gt; [5] doFuture_1.0.0           future_1.32.0            foreach_1.5.2            decider_0.0.0.9011      </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] httr_1.4.2           RcppParallel_5.1.5   StanHeaders_2.21.0-7 askpass_1.1          highr_0.9           </span></span>
<span><span class="co">#&gt;  [6] stats4_4.1.2         base64url_1.4        yaml_2.2.2           progress_1.2.2       globals_0.16.1      </span></span>
<span><span class="co">#&gt; [11] pillar_1.7.0         backports_1.4.1      glue_1.6.1           digest_0.6.29        checkmate_2.1.0     </span></span>
<span><span class="co">#&gt; [16] colorspace_2.0-3     htmltools_0.5.2      pkgconfig_2.0.3      rstan_2.21.5         listenv_0.8.0       </span></span>
<span><span class="co">#&gt; [21] purrr_0.3.4          scales_1.2.1         processx_3.8.1       brew_1.0-6           openxlsx_4.2.5.2    </span></span>
<span><span class="co">#&gt; [26] tibble_3.1.6         openssl_1.4.6        generics_0.1.1       farver_2.1.0         ggplot2_3.3.6       </span></span>
<span><span class="co">#&gt; [31] ellipsis_0.3.2       cachem_1.0.6         withr_2.5.0          cli_3.4.1            magrittr_2.0.2      </span></span>
<span><span class="co">#&gt; [36] crayon_1.5.1         memoise_2.0.1        evaluate_0.14        ps_1.6.0             fs_1.5.2            </span></span>
<span><span class="co">#&gt; [41] fansi_1.0.2          doParallel_1.0.17    pkgbuild_1.3.1       tools_4.1.2          loo_2.5.1           </span></span>
<span><span class="co">#&gt; [46] data.table_1.14.2    prettyunits_1.1.1    hms_1.1.1            lifecycle_1.0.3      matrixStats_0.62.0  </span></span>
<span><span class="co">#&gt; [51] stringr_1.4.0        munsell_0.5.0        zip_2.2.0            callr_3.7.3          pkgdown_2.0.7       </span></span>
<span><span class="co">#&gt; [56] compiler_4.1.2       rlang_1.0.6          grid_4.1.2           iterators_1.0.14     rstudioapi_0.13     </span></span>
<span><span class="co">#&gt; [61] rappdirs_0.3.3       labeling_0.4.2       rmarkdown_2.11       gtable_0.3.0         codetools_0.2-18    </span></span>
<span><span class="co">#&gt; [66] flock_0.7            inline_0.3.19        R6_2.5.1             gridExtra_2.3        knitr_1.37          </span></span>
<span><span class="co">#&gt; [71] dplyr_1.0.7          fastmap_1.1.0        future.apply_1.9.1   utf8_1.2.2           rprojroot_2.0.3     </span></span>
<span><span class="co">#&gt; [76] desc_1.4.1           stringi_1.7.6        parallel_4.1.2       Rcpp_1.0.8.3         vctrs_0.4.2         </span></span>
<span><span class="co">#&gt; [81] batchtools_0.9.17    tidyselect_1.1.1     xfun_0.29</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lukas Schroeter, Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
